<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>SQL进阶 | RP&#39;s Blog</title>
  <meta name="author" content="LRP">
  
  <meta name="description" content="SQL 是用于访问和处理数据库的标准的计算机语言。">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="SQL进阶"/>
  <meta property="og:site_name" content="RP&#39;s Blog"/>

  
    <meta property="og:image" content=""/>
  

  <link rel="alternate" href="/atom.xml" title="RP&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <!-- wumiiVerification -->
  <meta name="wumiiVerification" content="fb50a101-84fe-4ca2-91a7-ae8cf792978b" />
  <meta name="wumiiVerification" content="d73b5866-c390-4156-a4dd-51b526b5335e" />
  <!-- favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <!-- Font-Awesome -->
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">

</head>

<body>
  <header id="header"><div class= "header-content inner">
	<div class = "alignleft col-one">
		
			<div class='avatar'>
				<img src = "/img/default/avatar.jpg">
              </div>
		
		<div class="header-div">
		    <h1><a href="/">RP&#39;s Blog</a></h1>
		    <h2><a href="/">学习总结  思考感悟</a></h2>
		</div>
	</div>
	<div class = "alignright col-two">
		
	</div>
	<div class="clearfix"></div>
</div>

<div class= "header-nav">
	<div class='header-nav-content inner'>
		<div id="main-nav" class="alignleft">
		    		
		    		  <a href="/"><i class="fa fa-home"></i>首页</a>
		    		
		    		  <a href="/archives"><i class="fa fa-archive"></i>归档</a>
		    		
		</div>
		<div id="sub-nav" class="alignright">
		    
		      <a href="/atom.xml"><i class="fa fa-rss"></i>订阅</a>
		    
		      <a href="/about"><i class="fa fa-user"></i>关于</a>
		    
		</div>
	</div>
	<div class="clearfix"></div>
</div>
</header>
    <div id="content" class="inner">
      <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
        <div class="icon"></div>
        
        <time datetime="2017-03-06T16:00:00.000Z"><a href="/37559/">2017-03-07</a></time>
        
  
    <h1 class="title">SQL进阶</h1>
  

    </header>

    <div class="entry">
      
        
    <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-TOP-子句"><span class="toc-text">SQL TOP 子句</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#TOP-子句"><span class="toc-text">TOP 子句</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#SQL-Server-的语法："><span class="toc-text">SQL Server 的语法：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL-和-Oracle-中的-SQL-SELECT-TOP-是等价的"><span class="toc-text">MySQL 和 Oracle 中的 SQL SELECT TOP 是等价的</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MySQL-语法"><span class="toc-text">MySQL 语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Oracle-语法"><span class="toc-text">Oracle 语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原始的表-用在例子中的-："><span class="toc-text">原始的表 (用在例子中的)：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-TOP-实例"><span class="toc-text">SQL TOP 实例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-TOP-PERCENT-实例"><span class="toc-text">SQL TOP PERCENT 实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-LIKE-操作符"><span class="toc-text">SQL LIKE 操作符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#LIKE-操作符"><span class="toc-text">LIKE 操作符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-LIKE-操作符语法"><span class="toc-text">SQL LIKE 操作符语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原始的表-用在例子中的-：-1"><span class="toc-text">原始的表 (用在例子中的)：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LIKE-操作符实例"><span class="toc-text">LIKE 操作符实例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#例子-1"><span class="toc-text">例子 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#例子-2"><span class="toc-text">例子 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#例子-3"><span class="toc-text">例子 3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#例子-4"><span class="toc-text">例子 4</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-通配符"><span class="toc-text">SQL 通配符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-通配符-1"><span class="toc-text">SQL 通配符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原始的表-用在例子中的-：-2"><span class="toc-text">原始的表 (用在例子中的)：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-通配符"><span class="toc-text">使用 % 通配符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#例子-1-1"><span class="toc-text">例子 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#例子-2-1"><span class="toc-text">例子 2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-通配符-1"><span class="toc-text">使用 _ 通配符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#例子-1-2"><span class="toc-text">例子 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#例子-2-2"><span class="toc-text">例子 2</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-charlist-通配符"><span class="toc-text">使用 [charlist] 通配符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#例子-1-3"><span class="toc-text">例子 1</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#例子-2-3"><span class="toc-text">例子 2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-IN-操作符"><span class="toc-text">SQL IN 操作符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IN-操作符"><span class="toc-text">IN 操作符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-IN-语法"><span class="toc-text">SQL IN 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原始的表-在实例中使用："><span class="toc-text">原始的表 (在实例中使用：)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IN-操作符实例"><span class="toc-text">IN 操作符实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-BETWEEN-操作符"><span class="toc-text">SQL BETWEEN 操作符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BETWEEN-操作符"><span class="toc-text">BETWEEN 操作符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-BETWEEN-语法"><span class="toc-text">SQL BETWEEN 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原始的表-在实例中使用：-1"><span class="toc-text">原始的表 (在实例中使用：)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BETWEEN-操作符实例"><span class="toc-text">BETWEEN 操作符实例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#实例-2"><span class="toc-text">实例 2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-Alias（别名）"><span class="toc-text">SQL Alias（别名）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-Alias"><span class="toc-text">SQL Alias</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#表的-SQL-Alias-语法"><span class="toc-text">表的 SQL Alias 语法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#列的-SQL-Alias-语法"><span class="toc-text">列的 SQL Alias 语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Alias-实例-使用表名称别名"><span class="toc-text">Alias 实例: 使用表名称别名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Alias-实例-使用一个列名别名"><span class="toc-text">Alias 实例: 使用一个列名别名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-JOIN"><span class="toc-text">SQL JOIN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Join-和-Key"><span class="toc-text">Join 和 Key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#引用两个表"><span class="toc-text">引用两个表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-JOIN-使用-Join"><span class="toc-text">SQL JOIN - 使用 Join</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#不同的-SQL-JOIN"><span class="toc-text">不同的 SQL JOIN</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-INNER-JOIN-关键字"><span class="toc-text">SQL INNER JOIN 关键字</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-INNER-JOIN-关键字-1"><span class="toc-text">SQL INNER JOIN 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#INNER-JOIN-关键字语法"><span class="toc-text">INNER JOIN 关键字语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原始的表-用在例子中的-：-3"><span class="toc-text">原始的表 (用在例子中的)：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#内连接（INNER-JOIN）实例"><span class="toc-text">内连接（INNER JOIN）实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-LEFT-JOIN-关键字"><span class="toc-text">SQL LEFT JOIN 关键字</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-LEFT-JOIN-关键字-1"><span class="toc-text">SQL LEFT JOIN 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LEFT-JOIN-关键字语法"><span class="toc-text">LEFT JOIN 关键字语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原始的表-用在例子中的-：-4"><span class="toc-text">原始的表 (用在例子中的)：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#左连接（LEFT-JOIN）实例"><span class="toc-text">左连接（LEFT JOIN）实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-RIGHT-JOIN-关键字"><span class="toc-text">SQL RIGHT JOIN 关键字</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-RIGHT-JOIN-关键字-1"><span class="toc-text">SQL RIGHT JOIN 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RIGHT-JOIN-关键字语法"><span class="toc-text">RIGHT JOIN 关键字语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原始的表-用在例子中的-：-5"><span class="toc-text">原始的表 (用在例子中的)：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#右连接（RIGHT-JOIN）实例"><span class="toc-text">右连接（RIGHT JOIN）实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-FULL-JOIN-关键字"><span class="toc-text">SQL FULL JOIN 关键字</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-FULL-JOIN-关键字-1"><span class="toc-text">SQL FULL JOIN 关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FULL-JOIN-关键字语法"><span class="toc-text">FULL JOIN 关键字语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#原始的表-用在例子中的-：-6"><span class="toc-text">原始的表 (用在例子中的)：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#全连接（FULL-JOIN）实例"><span class="toc-text">全连接（FULL JOIN）实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-UNION-和-UNION-ALL-操作符"><span class="toc-text">SQL UNION 和 UNION ALL 操作符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-UNION-操作符"><span class="toc-text">SQL UNION 操作符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-UNION-语法"><span class="toc-text">SQL UNION 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-UNION-ALL-语法"><span class="toc-text">SQL UNION ALL 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#下面的例子中使用的原始表："><span class="toc-text">下面的例子中使用的原始表：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-UNION-命令"><span class="toc-text">使用 UNION 命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UNION-ALL"><span class="toc-text">UNION ALL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用-UNION-ALL-命令"><span class="toc-text">使用 UNION ALL 命令</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-SELECT-INTO-语句"><span class="toc-text">SQL SELECT INTO 语句</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SELECT-INTO-语句"><span class="toc-text">SELECT INTO 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-SELECT-INTO-语法"><span class="toc-text">SQL SELECT INTO 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-SELECT-INTO-实例-制作备份复件"><span class="toc-text">SQL SELECT INTO 实例 - 制作备份复件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-SELECT-INTO-实例-带有-WHERE-子句"><span class="toc-text">SQL SELECT INTO 实例 - 带有 WHERE 子句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-SELECT-INTO-实例-被连接的表"><span class="toc-text">SQL SELECT INTO 实例 - 被连接的表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-CREATE-DATABASE-语句"><span class="toc-text">SQL CREATE DATABASE 语句</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CREATE-DATABASE-语句"><span class="toc-text">CREATE DATABASE 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-CREATE-DATABASE-语法"><span class="toc-text">SQL CREATE DATABASE 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-CREATE-DATABASE-实例"><span class="toc-text">SQL CREATE DATABASE 实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-CREATE-TABLE-语句"><span class="toc-text">SQL CREATE TABLE 语句</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CREATE-TABLE-语句"><span class="toc-text">CREATE TABLE 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-CREATE-TABLE-语法"><span class="toc-text">SQL CREATE TABLE 语法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQL-CREATE-TABLE-实例"><span class="toc-text">SQL CREATE TABLE 实例</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL-服务器-RDBMS"><span class="toc-text">SQL 服务器 - RDBMS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DBMS-数据库管理系统（Database-Management-System）"><span class="toc-text">DBMS - 数据库管理系统（Database Management System）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RDBMS-关系数据库管理系统（Relational-Database-Management-System）"><span class="toc-text">RDBMS - 关系数据库管理系统（Relational Database Management System）</span></a></li></ol></li></ol>
    </div>

        <p>SQL 是用于访问和处理数据库的标准的计算机语言。</p>
<a id="more"></a>
<hr>
<h2 id="SQL-TOP-子句"><a href="#SQL-TOP-子句" class="headerlink" title="SQL TOP 子句"></a>SQL TOP 子句</h2><h3 id="TOP-子句"><a href="#TOP-子句" class="headerlink" title="TOP 子句"></a>TOP 子句</h3><p>TOP 子句用于规定要返回的记录的数目。</p>
<p>对于拥有数千条记录的大型表来说，TOP 子句是非常有用的。</p>
<p>注释：并非所有的数据库系统都支持 TOP 子句。</p>
<h4 id="SQL-Server-的语法："><a href="#SQL-Server-的语法：" class="headerlink" title="SQL Server 的语法："></a>SQL Server 的语法：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT TOP number|percent column_name(s)</span><br><span class="line">FROM table_name</span><br></pre></td></tr></table></figure>
<h3 id="MySQL-和-Oracle-中的-SQL-SELECT-TOP-是等价的"><a href="#MySQL-和-Oracle-中的-SQL-SELECT-TOP-是等价的" class="headerlink" title="MySQL 和 Oracle 中的 SQL SELECT TOP 是等价的"></a>MySQL 和 Oracle 中的 SQL SELECT TOP 是等价的</h3><h4 id="MySQL-语法"><a href="#MySQL-语法" class="headerlink" title="MySQL 语法"></a>MySQL 语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name</span><br><span class="line">LIMIT number</span><br></pre></td></tr></table></figure>
<p>例子<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM Persons</span><br><span class="line">LIMIT 5</span><br></pre></td></tr></table></figure></p>
<h4 id="Oracle-语法"><a href="#Oracle-语法" class="headerlink" title="Oracle 语法"></a>Oracle 语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE ROWNUM &lt;= number</span><br></pre></td></tr></table></figure>
<p>例子<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM Persons</span><br><span class="line">WHERE ROWNUM &lt;= 5</span><br></pre></td></tr></table></figure></p>
<h3 id="原始的表-用在例子中的-："><a href="#原始的表-用在例子中的-：" class="headerlink" title="原始的表 (用在例子中的)："></a>原始的表 (用在例子中的)：</h3><p>Persons 表:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br><span class="line">4	Obama	Barack	Pennsylvania Avenue	Washington</span><br></pre></td></tr></table></figure></p>
<h3 id="SQL-TOP-实例"><a href="#SQL-TOP-实例" class="headerlink" title="SQL TOP 实例"></a>SQL TOP 实例</h3><p>现在，我们希望从上面的 “Persons” 表中选取头两条记录。</p>
<p>我们可以使用下面的 SELECT 语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT TOP 2 * FROM Persons</span><br></pre></td></tr></table></figure>
<p>结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br></pre></td></tr></table></figure></p>
<h3 id="SQL-TOP-PERCENT-实例"><a href="#SQL-TOP-PERCENT-实例" class="headerlink" title="SQL TOP PERCENT 实例"></a>SQL TOP PERCENT 实例</h3><p>现在，我们希望从上面的 “Persons” 表中选取 50% 的记录。</p>
<p>我们可以使用下面的 SELECT 语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT TOP 50 PERCENT * FROM Persons</span><br></pre></td></tr></table></figure>
<p>结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="SQL-LIKE-操作符"><a href="#SQL-LIKE-操作符" class="headerlink" title="SQL LIKE 操作符"></a>SQL LIKE 操作符</h2><p>LIKE 操作符用于在 WHERE 子句中搜索列中的指定模式。</p>
<h3 id="LIKE-操作符"><a href="#LIKE-操作符" class="headerlink" title="LIKE 操作符"></a>LIKE 操作符</h3><p>LIKE 操作符用于在 WHERE 子句中搜索列中的指定模式。</p>
<h3 id="SQL-LIKE-操作符语法"><a href="#SQL-LIKE-操作符语法" class="headerlink" title="SQL LIKE 操作符语法"></a>SQL LIKE 操作符语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE column_name LIKE pattern</span><br></pre></td></tr></table></figure>
<h3 id="原始的表-用在例子中的-：-1"><a href="#原始的表-用在例子中的-：-1" class="headerlink" title="原始的表 (用在例子中的)："></a>原始的表 (用在例子中的)：</h3><p>Persons 表:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<h3 id="LIKE-操作符实例"><a href="#LIKE-操作符实例" class="headerlink" title="LIKE 操作符实例"></a>LIKE 操作符实例</h3><h4 id="例子-1"><a href="#例子-1" class="headerlink" title="例子 1"></a>例子 1</h4><p>现在，我们希望从上面的 “Persons” 表中选取居住在以 “N” 开始的城市里的人：</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE City LIKE &apos;N%&apos;</span><br></pre></td></tr></table></figure></p>
<p>提示：”%” 可用于定义通配符（模式中缺少的字母）。</p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br></pre></td></tr></table></figure></p>
<h4 id="例子-2"><a href="#例子-2" class="headerlink" title="例子 2"></a>例子 2</h4><p>接下来，我们希望从 “Persons” 表中选取居住在以 “g” 结尾的城市里的人：</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE City LIKE &apos;%g&apos;</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<h4 id="例子-3"><a href="#例子-3" class="headerlink" title="例子 3"></a>例子 3</h4><p>接下来，我们希望从 “Persons” 表中选取居住在包含 “lon” 的城市里的人：</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE City LIKE &apos;%lon%&apos;</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br></pre></td></tr></table></figure></p>
<h4 id="例子-4"><a href="#例子-4" class="headerlink" title="例子 4"></a>例子 4</h4><p>通过使用 NOT 关键字，我们可以从 “Persons” 表中选取居住在不包含 “lon” 的城市里的人：</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE City NOT LIKE &apos;%lon%&apos;</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="SQL-通配符"><a href="#SQL-通配符" class="headerlink" title="SQL 通配符"></a>SQL 通配符</h2><p>在搜索数据库中的数据时，您可以使用 SQL 通配符。</p>
<h3 id="SQL-通配符-1"><a href="#SQL-通配符-1" class="headerlink" title="SQL 通配符"></a>SQL 通配符</h3><p>在搜索数据库中的数据时，SQL 通配符可以替代一个或多个字符。</p>
<p>SQL 通配符必须与 LIKE 运算符一起使用。</p>
<p>在 SQL 中，可使用以下通配符：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">通配符	描述</span><br><span class="line">%	替代一个或多个字符</span><br><span class="line">_	仅替代一个字符</span><br><span class="line">[charlist]	字符列中的任何单一字符</span><br><span class="line">[^charlist] 或者 [!charlist]  不在字符列中的任何单一字符</span><br></pre></td></tr></table></figure></p>
<h3 id="原始的表-用在例子中的-：-2"><a href="#原始的表-用在例子中的-：-2" class="headerlink" title="原始的表 (用在例子中的)："></a>原始的表 (用在例子中的)：</h3><p>Persons 表:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<h3 id="使用-通配符"><a href="#使用-通配符" class="headerlink" title="使用 % 通配符"></a>使用 % 通配符</h3><h4 id="例子-1-1"><a href="#例子-1-1" class="headerlink" title="例子 1"></a>例子 1</h4><p>现在，我们希望从上面的 “Persons” 表中选取居住在以 “Ne” 开始的城市里的人：</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE City LIKE &apos;Ne%&apos;</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br></pre></td></tr></table></figure></p>
<h4 id="例子-2-1"><a href="#例子-2-1" class="headerlink" title="例子 2"></a>例子 2</h4><p>接下来，我们希望从 “Persons” 表中选取居住在包含 “lond” 的城市里的人：</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE City LIKE &apos;%lond%&apos;</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br></pre></td></tr></table></figure></p>
<h3 id="使用-通配符-1"><a href="#使用-通配符-1" class="headerlink" title="使用 _ 通配符"></a>使用 _ 通配符</h3><h4 id="例子-1-2"><a href="#例子-1-2" class="headerlink" title="例子 1"></a>例子 1</h4><p>现在，我们希望从上面的 “Persons” 表中选取名字的第一个字符之后是 “eorge” 的人：</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE FirstName LIKE &apos;_eorge&apos;</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br></pre></td></tr></table></figure></p>
<h4 id="例子-2-2"><a href="#例子-2-2" class="headerlink" title="例子 2"></a>例子 2</h4><p>接下来，我们希望从 “Persons” 表中选取的这条记录的姓氏以 “C” 开头，然后是一个任意字符，然后是 “r”，然后是任意字符，然后是 “er”：</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE LastName LIKE &apos;C_r_er&apos;</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<h3 id="使用-charlist-通配符"><a href="#使用-charlist-通配符" class="headerlink" title="使用 [charlist] 通配符"></a>使用 [charlist] 通配符</h3><h4 id="例子-1-3"><a href="#例子-1-3" class="headerlink" title="例子 1"></a>例子 1</h4><p>现在，我们希望从上面的 “Persons” 表中选取居住的城市以 “A” 或 “L” 或 “N” 开头的人：</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE City LIKE &apos;[ALN]%&apos;</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br></pre></td></tr></table></figure></p>
<h4 id="例子-2-3"><a href="#例子-2-3" class="headerlink" title="例子 2"></a>例子 2</h4><p>现在，我们希望从上面的 “Persons” 表中选取居住的城市不以 “A” 或 “L” 或 “N” 开头的人：</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE City LIKE &apos;[!ALN]%&apos;</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="SQL-IN-操作符"><a href="#SQL-IN-操作符" class="headerlink" title="SQL IN 操作符"></a>SQL IN 操作符</h2><h3 id="IN-操作符"><a href="#IN-操作符" class="headerlink" title="IN 操作符"></a>IN 操作符</h3><p>IN 操作符允许我们在 WHERE 子句中规定多个值。</p>
<h3 id="SQL-IN-语法"><a href="#SQL-IN-语法" class="headerlink" title="SQL IN 语法"></a>SQL IN 语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE column_name IN (value1,value2,...)</span><br></pre></td></tr></table></figure>
<h3 id="原始的表-在实例中使用："><a href="#原始的表-在实例中使用：" class="headerlink" title="原始的表 (在实例中使用：)"></a>原始的表 (在实例中使用：)</h3><p>Persons 表:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<h3 id="IN-操作符实例"><a href="#IN-操作符实例" class="headerlink" title="IN 操作符实例"></a>IN 操作符实例</h3><p>现在，我们希望从上表中选取姓氏为 Adams 和 Carter 的人：</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE LastName IN (&apos;Adams&apos;,&apos;Carter&apos;)</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="SQL-BETWEEN-操作符"><a href="#SQL-BETWEEN-操作符" class="headerlink" title="SQL BETWEEN 操作符"></a>SQL BETWEEN 操作符</h2><p>BETWEEN 操作符在 WHERE 子句中使用，作用是选取介于两个值之间的数据范围。</p>
<h3 id="BETWEEN-操作符"><a href="#BETWEEN-操作符" class="headerlink" title="BETWEEN 操作符"></a>BETWEEN 操作符</h3><p>操作符 BETWEEN … AND 会选取介于两个值之间的数据范围。这些值可以是数值、文本或者日期。</p>
<h3 id="SQL-BETWEEN-语法"><a href="#SQL-BETWEEN-语法" class="headerlink" title="SQL BETWEEN 语法"></a>SQL BETWEEN 语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name</span><br><span class="line">WHERE column_name</span><br><span class="line">BETWEEN value1 AND value2</span><br></pre></td></tr></table></figure>
<h3 id="原始的表-在实例中使用：-1"><a href="#原始的表-在实例中使用：-1" class="headerlink" title="原始的表 (在实例中使用：)"></a>原始的表 (在实例中使用：)</h3><p>Persons 表:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br><span class="line">4	Gates	Bill	Xuanwumen 10	Beijing</span><br></pre></td></tr></table></figure></p>
<h3 id="BETWEEN-操作符实例"><a href="#BETWEEN-操作符实例" class="headerlink" title="BETWEEN 操作符实例"></a>BETWEEN 操作符实例</h3><p>如需以字母顺序显示介于 “Adams”（包括）和 “Carter”（不包括）之间的人，请使用下面的 SQL：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE LastName</span><br><span class="line">BETWEEN &apos;Adams&apos; AND &apos;Carter&apos;</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br></pre></td></tr></table></figure></p>
<p>重要事项：不同的数据库对 BETWEEN…AND 操作符的处理方式是有差异的。某些数据库会列出介于 “Adams” 和 “Carter” 之间的人，但不包括 “Adams” 和 “Carter” ；某些数据库会列出介于 “Adams” 和 “Carter” 之间并包括 “Adams” 和 “Carter” 的人；而另一些数据库会列出介于 “Adams” 和 “Carter” 之间的人，包括 “Adams” ，但不包括 “Carter” 。</p>
<p>所以，请检查你的数据库是如何处理 BETWEEN….AND 操作符的！</p>
<h4 id="实例-2"><a href="#实例-2" class="headerlink" title="实例 2"></a>实例 2</h4><p>如需使用上面的例子显示范围之外的人，请使用 NOT 操作符：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM Persons</span><br><span class="line">WHERE LastName</span><br><span class="line">NOT BETWEEN &apos;Adams&apos; AND &apos;Carter&apos;</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br><span class="line">4	Gates	Bill	Xuanwumen 10	Beijing</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="SQL-Alias（别名）"><a href="#SQL-Alias（别名）" class="headerlink" title="SQL Alias（别名）"></a>SQL Alias（别名）</h2><p>通过使用 SQL，可以为列名称和表名称指定别名（Alias）。</p>
<h3 id="SQL-Alias"><a href="#SQL-Alias" class="headerlink" title="SQL Alias"></a>SQL Alias</h3><h4 id="表的-SQL-Alias-语法"><a href="#表的-SQL-Alias-语法" class="headerlink" title="表的 SQL Alias 语法"></a>表的 SQL Alias 语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name</span><br><span class="line">AS alias_name</span><br></pre></td></tr></table></figure>
<h4 id="列的-SQL-Alias-语法"><a href="#列的-SQL-Alias-语法" class="headerlink" title="列的 SQL Alias 语法"></a>列的 SQL Alias 语法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name AS alias_name</span><br><span class="line">FROM table_name</span><br></pre></td></tr></table></figure>
<h3 id="Alias-实例-使用表名称别名"><a href="#Alias-实例-使用表名称别名" class="headerlink" title="Alias 实例: 使用表名称别名"></a>Alias 实例: 使用表名称别名</h3><p>假设我们有两个表分别是：”Persons” 和 “Product_Orders”。我们分别为它们指定别名 “p” 和 “po”。</p>
<p>现在，我们希望列出 “John Adams” 的所有定单。</p>
<p>我们可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT po.OrderID, p.LastName, p.FirstName</span><br><span class="line">FROM Persons AS p, Product_Orders AS po</span><br><span class="line">WHERE p.LastName=&apos;Adams&apos; AND p.FirstName=&apos;John&apos;</span><br></pre></td></tr></table></figure></p>
<p>不使用别名的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT Product_Orders.OrderID, Persons.LastName, Persons.FirstName</span><br><span class="line">FROM Persons, Product_Orders</span><br><span class="line">WHERE Persons.LastName=&apos;Adams&apos; AND Persons.FirstName=&apos;John&apos;</span><br></pre></td></tr></table></figure></p>
<p>从上面两条 SELECT 语句您可以看到，别名使查询程序更易阅读和书写。</p>
<h3 id="Alias-实例-使用一个列名别名"><a href="#Alias-实例-使用一个列名别名" class="headerlink" title="Alias 实例: 使用一个列名别名"></a>Alias 实例: 使用一个列名别名</h3><p>表 Persons:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Id	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<p>SQL:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT LastName AS Family, FirstName AS Name</span><br><span class="line">FROM Persons</span><br></pre></td></tr></table></figure></p>
<p>结果：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Family	Name</span><br><span class="line">Adams	John</span><br><span class="line">Bush	George</span><br><span class="line">Carter	Thomas</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="SQL-JOIN"><a href="#SQL-JOIN" class="headerlink" title="SQL JOIN"></a>SQL JOIN</h2><p>SQL join 用于根据两个或多个表中的列之间的关系，从这些表中查询数据。</p>
<h3 id="Join-和-Key"><a href="#Join-和-Key" class="headerlink" title="Join 和 Key"></a>Join 和 Key</h3><p>有时为了得到完整的结果，我们需要从两个或更多的表中获取结果。我们就需要执行 join。</p>
<p>数据库中的表可通过键将彼此联系起来。主键（Primary Key）是一个列，在这个列中的每一行的值都是唯一的。在表中，每个主键的值都是唯一的。这样做的目的是在不重复每个表中的所有数据的情况下，把表间的数据交叉捆绑在一起。</p>
<p>请看 “Persons” 表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Id_P	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<p>请注意，”Id_P” 列是 Persons 表中的的主键。这意味着没有两行能够拥有相同的 Id_P。即使两个人的姓名完全相同，Id_P 也可以区分他们。</p>
<p>接下来请看 “Orders” 表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Id_O	OrderNo	Id_P</span><br><span class="line">1	77895	3</span><br><span class="line">2	44678	3</span><br><span class="line">3	22456	1</span><br><span class="line">4	24562	1</span><br><span class="line">5	34764	65</span><br></pre></td></tr></table></figure></p>
<p>请注意，”Id_O” 列是 Orders 表中的的主键，同时，”Orders” 表中的 “Id_P” 列用于引用 “Persons” 表中的人，而无需使用他们的确切姓名。</p>
<p>请留意，”Id_P” 列把上面的两个表联系了起来。</p>
<h3 id="引用两个表"><a href="#引用两个表" class="headerlink" title="引用两个表"></a>引用两个表</h3><p>我们可以通过引用两个表的方式，从两个表中获取数据：</p>
<p>谁订购了产品，并且他们订购了什么产品？<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT Persons.LastName, Persons.FirstName, Orders.OrderNo</span><br><span class="line">FROM Persons, Orders</span><br><span class="line">WHERE Persons.Id_P = Orders.Id_P</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LastName	FirstName	OrderNo</span><br><span class="line">Adams	John	22456</span><br><span class="line">Adams	John	24562</span><br><span class="line">Carter	Thomas	77895</span><br><span class="line">Carter	Thomas	44678</span><br></pre></td></tr></table></figure></p>
<h3 id="SQL-JOIN-使用-Join"><a href="#SQL-JOIN-使用-Join" class="headerlink" title="SQL JOIN - 使用 Join"></a>SQL JOIN - 使用 Join</h3><p>除了上面的方法，我们也可以使用关键词 JOIN 来从两个表中获取数据。</p>
<p>如果我们希望列出所有人的定购，可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT Persons.LastName, Persons.FirstName, Orders.OrderNo</span><br><span class="line">FROM Persons</span><br><span class="line">INNER JOIN Orders</span><br><span class="line">ON Persons.Id_P = Orders.Id_P</span><br><span class="line">ORDER BY Persons.LastName</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LastName	FirstName	OrderNo</span><br><span class="line">Adams	John	22456</span><br><span class="line">Adams	John	24562</span><br><span class="line">Carter	Thomas	77895</span><br><span class="line">Carter	Thomas	44678</span><br></pre></td></tr></table></figure></p>
<h3 id="不同的-SQL-JOIN"><a href="#不同的-SQL-JOIN" class="headerlink" title="不同的 SQL JOIN"></a>不同的 SQL JOIN</h3><p>除了我们在上面的例子中使用的 INNER JOIN（内连接），我们还可以使用其他几种连接。</p>
<p>下面列出了您可以使用的 JOIN 类型，以及它们之间的差异。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">JOIN: 如果表中有至少一个匹配，则返回行</span><br><span class="line">LEFT JOIN: 即使右表中没有匹配，也从左表返回所有的行</span><br><span class="line">RIGHT JOIN: 即使左表中没有匹配，也从右表返回所有的行</span><br><span class="line">FULL JOIN: 只要其中一个表中存在匹配，就返回行</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="SQL-INNER-JOIN-关键字"><a href="#SQL-INNER-JOIN-关键字" class="headerlink" title="SQL INNER JOIN 关键字"></a>SQL INNER JOIN 关键字</h2><h3 id="SQL-INNER-JOIN-关键字-1"><a href="#SQL-INNER-JOIN-关键字-1" class="headerlink" title="SQL INNER JOIN 关键字"></a>SQL INNER JOIN 关键字</h3><p>在表中存在至少一个匹配时，INNER JOIN 关键字返回行。</p>
<h3 id="INNER-JOIN-关键字语法"><a href="#INNER-JOIN-关键字语法" class="headerlink" title="INNER JOIN 关键字语法"></a>INNER JOIN 关键字语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name1</span><br><span class="line">INNER JOIN table_name2 </span><br><span class="line">ON table_name1.column_name=table_name2.column_name</span><br></pre></td></tr></table></figure>
<p>注释：INNER JOIN 与 JOIN 是相同的。</p>
<h3 id="原始的表-用在例子中的-：-3"><a href="#原始的表-用在例子中的-：-3" class="headerlink" title="原始的表 (用在例子中的)："></a>原始的表 (用在例子中的)：</h3><p>“Persons” 表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Id_P	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<p>“Orders” 表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Id_O	OrderNo	Id_P</span><br><span class="line">1	77895	3</span><br><span class="line">2	44678	3</span><br><span class="line">3	22456	1</span><br><span class="line">4	24562	1</span><br><span class="line">5	34764	65</span><br></pre></td></tr></table></figure></p>
<h3 id="内连接（INNER-JOIN）实例"><a href="#内连接（INNER-JOIN）实例" class="headerlink" title="内连接（INNER JOIN）实例"></a>内连接（INNER JOIN）实例</h3><p>现在，我们希望列出所有人的定购。</p>
<p>您可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT Persons.LastName, Persons.FirstName, Orders.OrderNo</span><br><span class="line">FROM Persons</span><br><span class="line">INNER JOIN Orders</span><br><span class="line">ON Persons.Id_P=Orders.Id_P</span><br><span class="line">ORDER BY Persons.LastName</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LastName	FirstName	OrderNo</span><br><span class="line">Adams	John	22456</span><br><span class="line">Adams	John	24562</span><br><span class="line">Carter	Thomas	77895</span><br><span class="line">Carter	Thomas	44678</span><br></pre></td></tr></table></figure></p>
<p>INNER JOIN 关键字在表中存在至少一个匹配时返回行。如果 “Persons” 中的行在 “Orders” 中没有匹配，就不会列出这些行。</p>
<hr>
<h2 id="SQL-LEFT-JOIN-关键字"><a href="#SQL-LEFT-JOIN-关键字" class="headerlink" title="SQL LEFT JOIN 关键字"></a>SQL LEFT JOIN 关键字</h2><h3 id="SQL-LEFT-JOIN-关键字-1"><a href="#SQL-LEFT-JOIN-关键字-1" class="headerlink" title="SQL LEFT JOIN 关键字"></a>SQL LEFT JOIN 关键字</h3><p>LEFT JOIN 关键字会从左表 (table_name1) 那里返回所有的行，即使在右表 (table_name2) 中没有匹配的行。</p>
<h3 id="LEFT-JOIN-关键字语法"><a href="#LEFT-JOIN-关键字语法" class="headerlink" title="LEFT JOIN 关键字语法"></a>LEFT JOIN 关键字语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name1</span><br><span class="line">LEFT JOIN table_name2 </span><br><span class="line">ON table_name1.column_name=table_name2.column_name</span><br></pre></td></tr></table></figure>
<p>注释：在某些数据库中， LEFT JOIN 称为 LEFT OUTER JOIN。</p>
<h3 id="原始的表-用在例子中的-：-4"><a href="#原始的表-用在例子中的-：-4" class="headerlink" title="原始的表 (用在例子中的)："></a>原始的表 (用在例子中的)：</h3><p>“Persons” 表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Id_P	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<p>“Orders” 表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Id_O	OrderNo	Id_P</span><br><span class="line">1	77895	3</span><br><span class="line">2	44678	3</span><br><span class="line">3	22456	1</span><br><span class="line">4	24562	1</span><br><span class="line">5	34764	65</span><br></pre></td></tr></table></figure></p>
<h3 id="左连接（LEFT-JOIN）实例"><a href="#左连接（LEFT-JOIN）实例" class="headerlink" title="左连接（LEFT JOIN）实例"></a>左连接（LEFT JOIN）实例</h3><p>现在，我们希望列出所有的人，以及他们的定购 - 如果有的话。</p>
<p>您可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT Persons.LastName, Persons.FirstName, Orders.OrderNo</span><br><span class="line">FROM Persons</span><br><span class="line">LEFT JOIN Orders</span><br><span class="line">ON Persons.Id_P=Orders.Id_P</span><br><span class="line">ORDER BY Persons.LastName</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LastName	FirstName	OrderNo</span><br><span class="line">Adams	John	22456</span><br><span class="line">Adams	John	24562</span><br><span class="line">Carter	Thomas	77895</span><br><span class="line">Carter	Thomas	44678</span><br><span class="line">Bush	George</span><br></pre></td></tr></table></figure></p>
<p>LEFT JOIN 关键字会从左表 (Persons) 那里返回所有的行，即使在右表 (Orders) 中没有匹配的行。</p>
<hr>
<h2 id="SQL-RIGHT-JOIN-关键字"><a href="#SQL-RIGHT-JOIN-关键字" class="headerlink" title="SQL RIGHT JOIN 关键字"></a>SQL RIGHT JOIN 关键字</h2><h3 id="SQL-RIGHT-JOIN-关键字-1"><a href="#SQL-RIGHT-JOIN-关键字-1" class="headerlink" title="SQL RIGHT JOIN 关键字"></a>SQL RIGHT JOIN 关键字</h3><p>RIGHT JOIN 关键字会右表 (table_name2) 那里返回所有的行，即使在左表 (table_name1) 中没有匹配的行。</p>
<h3 id="RIGHT-JOIN-关键字语法"><a href="#RIGHT-JOIN-关键字语法" class="headerlink" title="RIGHT JOIN 关键字语法"></a>RIGHT JOIN 关键字语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name1</span><br><span class="line">RIGHT JOIN table_name2 </span><br><span class="line">ON table_name1.column_name=table_name2.column_name</span><br></pre></td></tr></table></figure>
<p>注释：在某些数据库中， RIGHT JOIN 称为 RIGHT OUTER JOIN。</p>
<h3 id="原始的表-用在例子中的-：-5"><a href="#原始的表-用在例子中的-：-5" class="headerlink" title="原始的表 (用在例子中的)："></a>原始的表 (用在例子中的)：</h3><p>“Persons” 表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Id_P	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<p>“Orders” 表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Id_O	OrderNo	Id_P</span><br><span class="line">1	77895	3</span><br><span class="line">2	44678	3</span><br><span class="line">3	22456	1</span><br><span class="line">4	24562	1</span><br><span class="line">5	34764	65</span><br></pre></td></tr></table></figure></p>
<h3 id="右连接（RIGHT-JOIN）实例"><a href="#右连接（RIGHT-JOIN）实例" class="headerlink" title="右连接（RIGHT JOIN）实例"></a>右连接（RIGHT JOIN）实例</h3><p>现在，我们希望列出所有的定单，以及定购它们的人 - 如果有的话。</p>
<p>您可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT Persons.LastName, Persons.FirstName, Orders.OrderNo</span><br><span class="line">FROM Persons</span><br><span class="line">RIGHT JOIN Orders</span><br><span class="line">ON Persons.Id_P=Orders.Id_P</span><br><span class="line">ORDER BY Persons.LastName</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LastName	FirstName	OrderNo</span><br><span class="line">Adams	John	22456</span><br><span class="line">Adams	John	24562</span><br><span class="line">Carter	Thomas	77895</span><br><span class="line">Carter	Thomas	44678</span><br><span class="line"> 	 	34764</span><br></pre></td></tr></table></figure></p>
<p>RIGHT JOIN 关键字会从右表 (Orders) 那里返回所有的行，即使在左表 (Persons) 中没有匹配的行。</p>
<hr>
<h2 id="SQL-FULL-JOIN-关键字"><a href="#SQL-FULL-JOIN-关键字" class="headerlink" title="SQL FULL JOIN 关键字"></a>SQL FULL JOIN 关键字</h2><h3 id="SQL-FULL-JOIN-关键字-1"><a href="#SQL-FULL-JOIN-关键字-1" class="headerlink" title="SQL FULL JOIN 关键字"></a>SQL FULL JOIN 关键字</h3><p>只要其中某个表存在匹配，FULL JOIN 关键字就会返回行。</p>
<h3 id="FULL-JOIN-关键字语法"><a href="#FULL-JOIN-关键字语法" class="headerlink" title="FULL JOIN 关键字语法"></a>FULL JOIN 关键字语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">FROM table_name1</span><br><span class="line">FULL JOIN table_name2 </span><br><span class="line">ON table_name1.column_name=table_name2.column_name</span><br></pre></td></tr></table></figure>
<p>注释：在某些数据库中， FULL JOIN 称为 FULL OUTER JOIN。</p>
<h3 id="原始的表-用在例子中的-：-6"><a href="#原始的表-用在例子中的-：-6" class="headerlink" title="原始的表 (用在例子中的)："></a>原始的表 (用在例子中的)：</h3><p>“Persons” 表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Id_P	LastName	FirstName	Address	City</span><br><span class="line">1	Adams	John	Oxford Street	London</span><br><span class="line">2	Bush	George	Fifth Avenue	New York</span><br><span class="line">3	Carter	Thomas	Changan Street	Beijing</span><br></pre></td></tr></table></figure></p>
<p>“Orders” 表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Id_O	OrderNo	Id_P</span><br><span class="line">1	77895	3</span><br><span class="line">2	44678	3</span><br><span class="line">3	22456	1</span><br><span class="line">4	24562	1</span><br><span class="line">5	34764	65</span><br></pre></td></tr></table></figure></p>
<h3 id="全连接（FULL-JOIN）实例"><a href="#全连接（FULL-JOIN）实例" class="headerlink" title="全连接（FULL JOIN）实例"></a>全连接（FULL JOIN）实例</h3><p>现在，我们希望列出所有的人，以及他们的定单，以及所有的定单，以及定购它们的人。</p>
<p>您可以使用下面的 SELECT 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT Persons.LastName, Persons.FirstName, Orders.OrderNo</span><br><span class="line">FROM Persons</span><br><span class="line">FULL JOIN Orders</span><br><span class="line">ON Persons.Id_P=Orders.Id_P</span><br><span class="line">ORDER BY Persons.LastName</span><br></pre></td></tr></table></figure></p>
<p>结果集：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">LastName	FirstName	OrderNo</span><br><span class="line">Adams	John	22456</span><br><span class="line">Adams	John	24562</span><br><span class="line">Carter	Thomas	77895</span><br><span class="line">Carter	Thomas	44678</span><br><span class="line">Bush	George	 </span><br><span class="line"> 	 	34764</span><br></pre></td></tr></table></figure></p>
<p>FULL JOIN 关键字会从左表 (Persons) 和右表 (Orders) 那里返回所有的行。如果 “Persons” 中的行在表 “Orders” 中没有匹配，或者如果 “Orders” 中的行在表 “Persons” 中没有匹配，这些行同样会列出。</p>
<hr>
<h2 id="SQL-UNION-和-UNION-ALL-操作符"><a href="#SQL-UNION-和-UNION-ALL-操作符" class="headerlink" title="SQL UNION 和 UNION ALL 操作符"></a>SQL UNION 和 UNION ALL 操作符</h2><h3 id="SQL-UNION-操作符"><a href="#SQL-UNION-操作符" class="headerlink" title="SQL UNION 操作符"></a>SQL UNION 操作符</h3><p>UNION 操作符用于合并两个或多个 SELECT 语句的结果集。</p>
<p>请注意，UNION 内部的 SELECT 语句必须拥有相同数量的列。列也必须拥有相似的数据类型。同时，每条 SELECT 语句中的列的顺序必须相同。</p>
<h3 id="SQL-UNION-语法"><a href="#SQL-UNION-语法" class="headerlink" title="SQL UNION 语法"></a>SQL UNION 语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s) FROM table_name1</span><br><span class="line">UNION</span><br><span class="line">SELECT column_name(s) FROM table_name2</span><br></pre></td></tr></table></figure>
<p>注释：默认地，UNION 操作符选取不同的值。如果允许重复的值，请使用 UNION ALL。</p>
<h3 id="SQL-UNION-ALL-语法"><a href="#SQL-UNION-ALL-语法" class="headerlink" title="SQL UNION ALL 语法"></a>SQL UNION ALL 语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s) FROM table_name1</span><br><span class="line">UNION ALL</span><br><span class="line">SELECT column_name(s) FROM table_name2</span><br></pre></td></tr></table></figure>
<p>另外，UNION 结果集中的列名总是等于 UNION 中第一个 SELECT 语句中的列名。</p>
<h3 id="下面的例子中使用的原始表："><a href="#下面的例子中使用的原始表：" class="headerlink" title="下面的例子中使用的原始表："></a>下面的例子中使用的原始表：</h3><p>Employees_China:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">E_ID	E_Name</span><br><span class="line">01	Zhang, Hua</span><br><span class="line">02	Wang, Wei</span><br><span class="line">03	Carter, Thomas</span><br><span class="line">04	Yang, Ming</span><br></pre></td></tr></table></figure></p>
<p>Employees_USA:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">E_ID	E_Name</span><br><span class="line">01	Adams, John</span><br><span class="line">02	Bush, George</span><br><span class="line">03	Carter, Thomas</span><br><span class="line">04	Gates, Bill</span><br></pre></td></tr></table></figure></p>
<h3 id="使用-UNION-命令"><a href="#使用-UNION-命令" class="headerlink" title="使用 UNION 命令"></a>使用 UNION 命令</h3><p>实例<br>列出所有在中国和美国的不同的雇员名：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT E_Name FROM Employees_China</span><br><span class="line">UNION</span><br><span class="line">SELECT E_Name FROM Employees_USA</span><br></pre></td></tr></table></figure></p>
<p>结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">E_Name</span><br><span class="line">Zhang, Hua</span><br><span class="line">Wang, Wei</span><br><span class="line">Carter, Thomas</span><br><span class="line">Yang, Ming</span><br><span class="line">Adams, John</span><br><span class="line">Bush, George</span><br><span class="line">Gates, Bill</span><br></pre></td></tr></table></figure></p>
<p>注释：这个命令无法列出在中国和美国的所有雇员。在上面的例子中，我们有两个名字相同的雇员，他们当中只有一个人被列出来了。UNION 命令只会选取不同的值。</p>
<h3 id="UNION-ALL"><a href="#UNION-ALL" class="headerlink" title="UNION ALL"></a>UNION ALL</h3><p>UNION ALL 命令和 UNION 命令几乎是等效的，不过 UNION ALL 命令会列出所有的值。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SQL Statement 1</span><br><span class="line">UNION ALL</span><br><span class="line">SQL Statement 2</span><br></pre></td></tr></table></figure></p>
<h3 id="使用-UNION-ALL-命令"><a href="#使用-UNION-ALL-命令" class="headerlink" title="使用 UNION ALL 命令"></a>使用 UNION ALL 命令</h3><p>实例：<br>列出在中国和美国的所有的雇员：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT E_Name FROM Employees_China</span><br><span class="line">UNION ALL</span><br><span class="line">SELECT E_Name FROM Employees_USA</span><br></pre></td></tr></table></figure></p>
<p>结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">E_Name</span><br><span class="line">Zhang, Hua</span><br><span class="line">Wang, Wei</span><br><span class="line">Carter, Thomas</span><br><span class="line">Yang, Ming</span><br><span class="line">Adams, John</span><br><span class="line">Bush, George</span><br><span class="line">Carter, Thomas</span><br><span class="line">Gates, Bill</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="SQL-SELECT-INTO-语句"><a href="#SQL-SELECT-INTO-语句" class="headerlink" title="SQL SELECT INTO 语句"></a>SQL SELECT INTO 语句</h2><p>SQL SELECT INTO 语句可用于创建表的备份复件。</p>
<h3 id="SELECT-INTO-语句"><a href="#SELECT-INTO-语句" class="headerlink" title="SELECT INTO 语句"></a>SELECT INTO 语句</h3><p>SELECT INTO 语句从一个表中选取数据，然后把数据插入另一个表中。</p>
<p>SELECT INTO 语句常用于创建表的备份复件或者用于对记录进行存档。</p>
<h3 id="SQL-SELECT-INTO-语法"><a href="#SQL-SELECT-INTO-语法" class="headerlink" title="SQL SELECT INTO 语法"></a>SQL SELECT INTO 语法</h3><p>您可以把所有的列插入新表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">INTO new_table_name [IN externaldatabase] </span><br><span class="line">FROM old_tablename</span><br></pre></td></tr></table></figure></p>
<p>或者只把希望的列插入新表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name(s)</span><br><span class="line">INTO new_table_name [IN externaldatabase] </span><br><span class="line">FROM old_tablename</span><br></pre></td></tr></table></figure></p>
<h3 id="SQL-SELECT-INTO-实例-制作备份复件"><a href="#SQL-SELECT-INTO-实例-制作备份复件" class="headerlink" title="SQL SELECT INTO 实例 - 制作备份复件"></a>SQL SELECT INTO 实例 - 制作备份复件</h3><p>下面的例子会制作 “Persons” 表的备份复件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">INTO Persons_backup</span><br><span class="line">FROM Persons</span><br></pre></td></tr></table></figure></p>
<p>IN 子句可用于向另一个数据库中拷贝表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">INTO Persons IN &apos;Backup.mdb&apos;</span><br><span class="line">FROM Persons</span><br></pre></td></tr></table></figure></p>
<p>如果我们希望拷贝某些域，可以在 SELECT 语句后列出这些域：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT LastName,FirstName</span><br><span class="line">INTO Persons_backup</span><br><span class="line">FROM Persons</span><br></pre></td></tr></table></figure></p>
<h3 id="SQL-SELECT-INTO-实例-带有-WHERE-子句"><a href="#SQL-SELECT-INTO-实例-带有-WHERE-子句" class="headerlink" title="SQL SELECT INTO 实例 - 带有 WHERE 子句"></a>SQL SELECT INTO 实例 - 带有 WHERE 子句</h3><p>我们也可以添加 WHERE 子句。</p>
<p>下面的例子通过从 “Persons” 表中提取居住在 “Beijing” 的人的信息，创建了一个带有两个列的名为 “Persons_backup” 的表：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT LastName,Firstname</span><br><span class="line">INTO Persons_backup</span><br><span class="line">FROM Persons</span><br><span class="line">WHERE City=&apos;Beijing&apos;</span><br></pre></td></tr></table></figure></p>
<h3 id="SQL-SELECT-INTO-实例-被连接的表"><a href="#SQL-SELECT-INTO-实例-被连接的表" class="headerlink" title="SQL SELECT INTO 实例 - 被连接的表"></a>SQL SELECT INTO 实例 - 被连接的表</h3><p>从一个以上的表中选取数据也是可以做到的。</p>
<p>下面的例子会创建一个名为 “Persons_Order_Backup” 的新表，其中包含了从 Persons 和 Orders 两个表中取得的信息：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT Persons.LastName,Orders.OrderNo</span><br><span class="line">INTO Persons_Order_Backup</span><br><span class="line">FROM Persons</span><br><span class="line">INNER JOIN Orders</span><br><span class="line">ON Persons.Id_P=Orders.Id_P</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="SQL-CREATE-DATABASE-语句"><a href="#SQL-CREATE-DATABASE-语句" class="headerlink" title="SQL CREATE DATABASE 语句"></a>SQL CREATE DATABASE 语句</h2><h3 id="CREATE-DATABASE-语句"><a href="#CREATE-DATABASE-语句" class="headerlink" title="CREATE DATABASE 语句"></a>CREATE DATABASE 语句</h3><p>CREATE DATABASE 用于创建数据库。</p>
<h3 id="SQL-CREATE-DATABASE-语法"><a href="#SQL-CREATE-DATABASE-语法" class="headerlink" title="SQL CREATE DATABASE 语法"></a>SQL CREATE DATABASE 语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE database_name</span><br></pre></td></tr></table></figure>
<h3 id="SQL-CREATE-DATABASE-实例"><a href="#SQL-CREATE-DATABASE-实例" class="headerlink" title="SQL CREATE DATABASE 实例"></a>SQL CREATE DATABASE 实例</h3><p>现在我们希望创建一个名为 “my_db” 的数据库。</p>
<p>我们使用下面的 CREATE DATABASE 语句：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE my_db</span><br></pre></td></tr></table></figure></p>
<p>可以通过 CREATE TABLE 来添加数据库表。</p>
<hr>
<h2 id="SQL-CREATE-TABLE-语句"><a href="#SQL-CREATE-TABLE-语句" class="headerlink" title="SQL CREATE TABLE 语句"></a>SQL CREATE TABLE 语句</h2><h3 id="CREATE-TABLE-语句"><a href="#CREATE-TABLE-语句" class="headerlink" title="CREATE TABLE 语句"></a>CREATE TABLE 语句</h3><p>CREATE TABLE 语句用于创建数据库中的表。</p>
<h3 id="SQL-CREATE-TABLE-语法"><a href="#SQL-CREATE-TABLE-语法" class="headerlink" title="SQL CREATE TABLE 语法"></a>SQL CREATE TABLE 语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE 表名称</span><br><span class="line">(</span><br><span class="line">列名称1 数据类型,</span><br><span class="line">列名称2 数据类型,</span><br><span class="line">列名称3 数据类型,</span><br><span class="line">....</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>数据类型（data_type）规定了列可容纳何种数据类型。下面的表格包含了SQL中最常用的数据类型：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">数据类型	描述</span><br><span class="line">integer(size)</span><br><span class="line">int(size)</span><br><span class="line">smallint(size)</span><br><span class="line">tinyint(size)</span><br></pre></td></tr></table></figure></p>
<p>仅容纳整数。在括号内规定数字的最大位数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">decimal(size,d)</span><br><span class="line">numeric(size,d)</span><br></pre></td></tr></table></figure></p>
<p>容纳带有小数的数字。</p>
<p>“size” 规定数字的最大位数。”d” 规定小数点右侧的最大位数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">char(size)</span><br></pre></td></tr></table></figure></p>
<p>容纳固定长度的字符串（可容纳字母、数字以及特殊字符）。</p>
<p>在括号中规定字符串的长度。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">varchar(size)</span><br></pre></td></tr></table></figure></p>
<p>容纳可变长度的字符串（可容纳字母、数字以及特殊的字符）。</p>
<p>在括号中规定字符串的最大长度。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">date(yyyymmdd)</span><br></pre></td></tr></table></figure></p>
<p>容纳日期。</p>
<h3 id="SQL-CREATE-TABLE-实例"><a href="#SQL-CREATE-TABLE-实例" class="headerlink" title="SQL CREATE TABLE 实例"></a>SQL CREATE TABLE 实例</h3><p>本例演示如何创建名为 “Person” 的表。</p>
<p>该表包含 5 个列，列名分别是：”Id_P”、”LastName”、”FirstName”、”Address” 以及 “City”：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE Persons</span><br><span class="line">(</span><br><span class="line">Id_P int,</span><br><span class="line">LastName varchar(255),</span><br><span class="line">FirstName varchar(255),</span><br><span class="line">Address varchar(255),</span><br><span class="line">City varchar(255)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>Id_P 列的数据类型是 int，包含整数。其余 4 列的数据类型是 varchar，最大长度为 255 个字符。</p>
<p>空的 “Persons” 表类似这样：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Id_P	LastName	FirstName	Address	City</span><br><span class="line">``` 	 	 	 	 </span><br><span class="line">可使用 INSERT INTO 语句向空表写入数据。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL 约束 (Constraints) ##</span><br><span class="line"></span><br><span class="line">### SQL 约束 ###</span><br><span class="line">约束用于限制加入表的数据的类型。</span><br><span class="line"></span><br><span class="line">可以在创建表时规定约束（通过 CREATE TABLE 语句），或者在表创建之后也可以（通过 ALTER TABLE 语句）。</span><br><span class="line"></span><br><span class="line">我们将主要探讨以下几种约束：</span><br></pre></td></tr></table></figure></p>
<p>NOT NULL<br>UNIQUE<br>PRIMARY KEY<br>FOREIGN KEY<br>CHECK<br>DEFAULT<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">注释：在下面，我们会详细讲解每一种约束。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL NOT NULL 约束 ##</span><br><span class="line">NOT NULL 约束强制列不接受 NULL 值。</span><br><span class="line"></span><br><span class="line">NOT NULL 约束强制字段始终包含值。这意味着，如果不向字段添加值，就无法插入新记录或者更新记录。</span><br><span class="line"></span><br><span class="line">下面的 SQL 语句强制 &quot;Id_P&quot; 列和 &quot;LastName&quot; 列不接受 NULL 值：</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>Id_P int NOT NULL,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL UNIQUE 约束 ##</span><br><span class="line"></span><br><span class="line">### SQL UNIQUE 约束 ###</span><br><span class="line">UNIQUE 约束唯一标识数据库表中的每条记录。</span><br><span class="line"></span><br><span class="line">UNIQUE 和 PRIMARY KEY 约束均为列或列集合提供了唯一性的保证。</span><br><span class="line"></span><br><span class="line">PRIMARY KEY 拥有自动定义的 UNIQUE 约束。</span><br><span class="line"></span><br><span class="line">请注意，每个表可以有多个 UNIQUE 约束，但是每个表只能有一个 PRIMARY KEY 约束。</span><br><span class="line"></span><br><span class="line">### SQL UNIQUE Constraint on CREATE TABLE ###</span><br><span class="line">下面的 SQL 在 &quot;Persons&quot; 表创建时在 &quot;Id_P&quot; 列创建 UNIQUE 约束：</span><br><span class="line"></span><br><span class="line">MySQL:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>Id_P int NOT NULL,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255),<br>UNIQUE (Id_P)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>Id_P int NOT NULL UNIQUE,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果需要命名 UNIQUE 约束，以及为多个列定义 UNIQUE 约束，请使用下面的 SQL 语法：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>Id_P int NOT NULL,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255),<br>CONSTRAINT uc_PersonID UNIQUE (Id_P,LastName)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### SQL UNIQUE Constraint on ALTER TABLE ###</span><br><span class="line">当表已被创建时，如需在 &quot;Id_P&quot; 列创建 UNIQUE 约束，请使用下列 SQL：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>ADD UNIQUE (Id_P)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如需命名 UNIQUE 约束，并定义多个列的 UNIQUE 约束，请使用下面的 SQL 语法：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>ADD CONSTRAINT uc_PersonID UNIQUE (Id_P,LastName)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">### 撤销 UNIQUE 约束 ###</span><br><span class="line">如需撤销 UNIQUE 约束，请使用下面的 SQL：</span><br><span class="line"></span><br><span class="line">MySQL:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>DROP INDEX uc_PersonID<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>DROP CONSTRAINT uc_PersonID<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL PRIMARY KEY 约束 ##</span><br><span class="line"></span><br><span class="line">### SQL PRIMARY KEY 约束 ###</span><br><span class="line">PRIMARY KEY 约束唯一标识数据库表中的每条记录。</span><br><span class="line"></span><br><span class="line">主键必须包含唯一的值。</span><br><span class="line"></span><br><span class="line">主键列不能包含 NULL 值。</span><br><span class="line"></span><br><span class="line">每个表都应该有一个主键，并且每个表只能有一个主键。</span><br><span class="line"></span><br><span class="line">### SQL PRIMARY KEY Constraint on CREATE TABLE ###</span><br><span class="line">下面的 SQL 在 &quot;Persons&quot; 表创建时在 &quot;Id_P&quot; 列创建 PRIMARY KEY 约束：</span><br><span class="line"></span><br><span class="line">MySQL:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>Id_P int NOT NULL,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255),<br>PRIMARY KEY (Id_P)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>Id_P int NOT NULL PRIMARY KEY,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果需要命名 PRIMARY KEY 约束，以及为多个列定义 PRIMARY KEY 约束，请使用下面的 SQL 语法：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>Id_P int NOT NULL,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255),<br>CONSTRAINT pk_PersonID PRIMARY KEY (Id_P,LastName)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### SQL PRIMARY KEY Constraint on ALTER TABLE ###</span><br><span class="line">如果在表已存在的情况下为 &quot;Id_P&quot; 列创建 PRIMARY KEY 约束，请使用下面的 SQL：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>ADD PRIMARY KEY (Id_P)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果需要命名 PRIMARY KEY 约束，以及为多个列定义 PRIMARY KEY 约束，请使用下面的 SQL 语法：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>ADD CONSTRAINT pk_PersonID PRIMARY KEY (Id_P,LastName)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">注释：如果您使用 ALTER TABLE 语句添加主键，必须把主键列声明为不包含 NULL 值（在表首次创建时）。</span><br><span class="line"></span><br><span class="line">### 撤销 PRIMARY KEY 约束 ###</span><br><span class="line">如需撤销 PRIMARY KEY 约束，请使用下面的 SQL：</span><br><span class="line"></span><br><span class="line">MySQL:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>DROP PRIMARY KEY<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>DROP CONSTRAINT pk_PersonID<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL FOREIGN KEY 约束 ##</span><br><span class="line"></span><br><span class="line">### SQL FOREIGN KEY 约束 ###</span><br><span class="line">一个表中的 FOREIGN KEY 指向另一个表中的 PRIMARY KEY。</span><br><span class="line"></span><br><span class="line">让我们通过一个例子来解释外键。请看下面两个表：</span><br><span class="line"></span><br><span class="line">&quot;Persons&quot; 表：</span><br></pre></td></tr></table></figure></p>
<p>Id_P    LastName    FirstName    Address    City<br>1    Adams    John    Oxford Street    London<br>2    Bush    George    Fifth Avenue    New York<br>3    Carter    Thomas    Changan Street    Beijing<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Orders&quot; 表：</span><br></pre></td></tr></table></figure></p>
<p>Id_O    OrderNo    Id_P<br>1    77895    3<br>2    44678    3<br>3    22456    1<br>4    24562    1<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">请注意，&quot;Orders&quot; 中的 &quot;Id_P&quot; 列指向 &quot;Persons&quot; 表中的 &quot;Id_P&quot; 列。</span><br><span class="line"></span><br><span class="line">&quot;Persons&quot; 表中的 &quot;Id_P&quot; 列是 &quot;Persons&quot; 表中的 PRIMARY KEY。</span><br><span class="line"></span><br><span class="line">&quot;Orders&quot; 表中的 &quot;Id_P&quot; 列是 &quot;Orders&quot; 表中的 FOREIGN KEY。</span><br><span class="line"></span><br><span class="line">FOREIGN KEY 约束用于预防破坏表之间连接的动作。</span><br><span class="line"></span><br><span class="line">FOREIGN KEY 约束也能防止非法数据插入外键列，因为它必须是它指向的那个表中的值之一。</span><br><span class="line"></span><br><span class="line">### SQL FOREIGN KEY Constraint on CREATE TABLE ###</span><br><span class="line">下面的 SQL 在 &quot;Orders&quot; 表创建时为 &quot;Id_P&quot; 列创建 FOREIGN KEY：</span><br><span class="line"></span><br><span class="line">MySQL:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Orders<br>(<br>Id_O int NOT NULL,<br>OrderNo int NOT NULL,<br>Id_P int,<br>PRIMARY KEY (Id_O),<br>FOREIGN KEY (Id_P) REFERENCES Persons(Id_P)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Orders<br>(<br>Id_O int NOT NULL PRIMARY KEY,<br>OrderNo int NOT NULL,<br>Id_P int FOREIGN KEY REFERENCES Persons(Id_P)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果需要命名 FOREIGN KEY 约束，以及为多个列定义 FOREIGN KEY 约束，请使用下面的 SQL 语法：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Orders<br>(<br>Id_O int NOT NULL,<br>OrderNo int NOT NULL,<br>Id_P int,<br>PRIMARY KEY (Id_O),<br>CONSTRAINT fk_PerOrders FOREIGN KEY (Id_P)<br>REFERENCES Persons(Id_P)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">### SQL FOREIGN KEY Constraint on ALTER TABLE ###</span><br><span class="line">如果在 &quot;Orders&quot; 表已存在的情况下为 &quot;Id_P&quot; 列创建 FOREIGN KEY 约束，请使用下面的 SQL：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Orders<br>ADD FOREIGN KEY (Id_P)<br>REFERENCES Persons(Id_P)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果需要命名 FOREIGN KEY 约束，以及为多个列定义 FOREIGN KEY 约束，请使用下面的 SQL 语法：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Orders<br>ADD CONSTRAINT fk_PerOrders<br>FOREIGN KEY (Id_P)<br>REFERENCES Persons(Id_P)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 撤销 FOREIGN KEY 约束 ###</span><br><span class="line">如需撤销 FOREIGN KEY 约束，请使用下面的 SQL：</span><br><span class="line"></span><br><span class="line">MySQL:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Orders<br>DROP FOREIGN KEY fk_PerOrders<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Orders<br>DROP CONSTRAINT fk_PerOrders<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL CHECK 约束 ##</span><br><span class="line"></span><br><span class="line">### SQL CHECK 约束 ###</span><br><span class="line">CHECK 约束用于限制列中的值的范围。</span><br><span class="line"></span><br><span class="line">如果对单个列定义 CHECK 约束，那么该列只允许特定的值。</span><br><span class="line"></span><br><span class="line">如果对一个表定义 CHECK 约束，那么此约束会在特定的列中对值进行限制。</span><br><span class="line"></span><br><span class="line">### SQL CHECK Constraint on CREATE TABLE ###</span><br><span class="line">下面的 SQL 在 &quot;Persons&quot; 表创建时为 &quot;Id_P&quot; 列创建 CHECK 约束。CHECK 约束规定 &quot;Id_P&quot; 列必须只包含大于 0 的整数。</span><br><span class="line"></span><br><span class="line">My SQL:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>Id_P int NOT NULL,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255),<br>CHECK (Id_P&gt;0)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>Id_P int NOT NULL CHECK (Id_P&gt;0),<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果需要命名 CHECK 约束，以及为多个列定义 CHECK 约束，请使用下面的 SQL 语法：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>Id_P int NOT NULL,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255),<br>CONSTRAINT chk_Person CHECK (Id_P&gt;0 AND City=’Sandnes’)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### SQL CHECK Constraint on ALTER TABLE ###</span><br><span class="line">如果在表已存在的情况下为 &quot;Id_P&quot; 列创建 CHECK 约束，请使用下面的 SQL：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>ADD CHECK (Id_P&gt;0)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">如果需要命名 CHECK 约束，以及为多个列定义 CHECK 约束，请使用下面的 SQL 语法：</span><br><span class="line"></span><br><span class="line">MySQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>ADD CONSTRAINT chk_Person CHECK (Id_P&gt;0 AND City=’Sandnes’)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 撤销 CHECK 约束 ###</span><br><span class="line">如需撤销 CHECK 约束，请使用下面的 SQL：</span><br><span class="line"></span><br><span class="line">SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>DROP CONSTRAINT chk_Person<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MySQL:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>DROP CHECK chk_Person<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL DEFAULT 约束 ##</span><br><span class="line"></span><br><span class="line">### SQL DEFAULT 约束 ###</span><br><span class="line">DEFAULT 约束用于向列中插入默认值。</span><br><span class="line"></span><br><span class="line">如果没有规定其他的值，那么会将默认值添加到所有的新记录。</span><br><span class="line"></span><br><span class="line">### SQL DEFAULT Constraint on CREATE TABLE ###</span><br><span class="line">下面的 SQL 在 &quot;Persons&quot; 表创建时为 &quot;City&quot; 列创建 DEFAULT 约束：</span><br><span class="line"></span><br><span class="line">My SQL / SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>Id_P int NOT NULL,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255) DEFAULT ‘Sandnes’<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">通过使用类似 GETDATE() 这样的函数，DEFAULT 约束也可以用于插入系统值：</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Orders<br>(<br>Id_O int NOT NULL,<br>OrderNo int NOT NULL,<br>Id_P int,<br>OrderDate date DEFAULT GETDATE()<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### SQL DEFAULT Constraint on ALTER TABLE ###</span><br><span class="line">如果在表已存在的情况下为 &quot;City&quot; 列创建 DEFAULT 约束，请使用下面的 SQL：</span><br><span class="line"></span><br><span class="line">MySQL:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>ALTER City SET DEFAULT ‘SANDNES’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>LTER TABLE Persons<br>ALTER COLUMN City SET DEFAULT ‘SANDNES’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">### 撤销 DEFAULT 约束 ###</span><br><span class="line">如需撤销 DEFAULT 约束，请使用下面的 SQL：</span><br><span class="line"></span><br><span class="line">MySQL:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>ALTER City DROP DEFAULT<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL Server / Oracle / MS Access:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>ALTER COLUMN City DROP DEFAULT<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL CREATE INDEX 语句 ##</span><br><span class="line"></span><br><span class="line">CREATE INDEX 语句用于在表中创建索引。</span><br><span class="line"></span><br><span class="line">在不读取整个表的情况下，索引使数据库应用程序可以更快地查找数据。</span><br><span class="line"></span><br><span class="line">### 索引 ###</span><br><span class="line">您可以在表中创建索引，以便更加快速高效地查询数据。</span><br><span class="line"></span><br><span class="line">用户无法看到索引，它们只能被用来加速搜索/查询。</span><br><span class="line"></span><br><span class="line">注释：更新一个包含索引的表需要比更新一个没有索引的表更多的时间，这是由于索引本身也需要更新。因此，理想的做法是仅仅在常常被搜索的列（以及表）上面创建索引。</span><br><span class="line"></span><br><span class="line">### SQL CREATE INDEX 语法 ###</span><br><span class="line">在表上创建一个简单的索引。允许使用重复的值：</span><br></pre></td></tr></table></figure></p>
<p>CREATE INDEX index_name<br>ON table_name (column_name)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">注释：&quot;column_name&quot; 规定需要索引的列。</span><br><span class="line"></span><br><span class="line">### SQL CREATE UNIQUE INDEX 语法 ###</span><br><span class="line">在表上创建一个唯一的索引。唯一的索引意味着两个行不能拥有相同的索引值。</span><br></pre></td></tr></table></figure></p>
<p>CREATE UNIQUE INDEX index_name<br>ON table_name (column_name)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### CREATE INDEX 实例 ###</span><br><span class="line">本例会创建一个简单的索引，名为 &quot;PersonIndex&quot;，在 Person 表的 LastName 列：</span><br></pre></td></tr></table></figure></p>
<p>CREATE INDEX PersonIndex<br>ON Person (LastName)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如果您希望以降序索引某个列中的值，您可以在列名称之后添加保留字 DESC：</span><br></pre></td></tr></table></figure></p>
<p>CREATE INDEX PersonIndex<br>ON Person (LastName DESC)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">假如您希望索引不止一个列，您可以在括号中列出这些列的名称，用逗号隔开：</span><br></pre></td></tr></table></figure></p>
<p>CREATE INDEX PersonIndex<br>ON Person (LastName, FirstName)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL 撤销索引、表以及数据库 ##</span><br><span class="line"></span><br><span class="line">通过使用 DROP 语句，可以轻松地删除索引、表和数据库。</span><br><span class="line"></span><br><span class="line">### SQL DROP INDEX 语句 ###</span><br><span class="line">我们可以使用 DROP INDEX 命令删除表格中的索引。</span><br><span class="line"></span><br><span class="line">用于 Microsoft SQLJet (以及 Microsoft Access) 的语法:</span><br></pre></td></tr></table></figure></p>
<p>DROP INDEX index_name ON table_name<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用于 MS SQL Server 的语法:</span><br></pre></td></tr></table></figure></p>
<p>DROP INDEX table_name.index_name<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用于 IBM DB2 和 Oracle 语法:</span><br></pre></td></tr></table></figure></p>
<p>DROP INDEX index_name<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用于 MySQL 的语法:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE table_name DROP INDEX index_name<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">### SQL DROP TABLE 语句 ###</span><br><span class="line">DROP TABLE 语句用于删除表（表的结构、属性以及索引也会被删除）：</span><br></pre></td></tr></table></figure></p>
<p>DROP TABLE 表名称<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">### SQL DROP DATABASE 语句 ###</span><br><span class="line"></span><br><span class="line">DROP DATABASE 语句用于删除数据库：</span><br></pre></td></tr></table></figure></p>
<p>DROP DATABASE 数据库名称<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">### SQL TRUNCATE TABLE 语句 ###</span><br><span class="line">如果我们仅仅需要除去表内的数据，但并不删除表本身，那么我们该如何做呢？</span><br><span class="line"></span><br><span class="line">请使用 TRUNCATE TABLE 命令（仅仅删除表格中的数据）：</span><br></pre></td></tr></table></figure></p>
<p>TRUNCATE TABLE 表名称<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL ALTER TABLE 语句 ##</span><br><span class="line"></span><br><span class="line">### ALTER TABLE 语句 ###</span><br><span class="line">ALTER TABLE 语句用于在已有的表中添加、修改或删除列。</span><br><span class="line"></span><br><span class="line">### SQL ALTER TABLE 语法 ###</span><br><span class="line">如需在表中添加列，请使用下列语法:</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE table_name<br>ADD column_name datatype<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">要删除表中的列，请使用下列语法：</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE table_name<br>DROP COLUMN column_name<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">注释：某些数据库系统不允许这种在数据库表中删除列的方式 (DROP COLUMN column_name)。</span><br><span class="line"></span><br><span class="line">要改变表中列的数据类型，请使用下列语法：</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE table_name<br>ALTER COLUMN column_name datatype<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 原始的表 (用在例子中的)： ###</span><br><span class="line">Persons 表:</span><br></pre></td></tr></table></figure></p>
<p>Id    LastName    FirstName    Address    City<br>1    Adams    John    Oxford Street    London<br>2    Bush    George    Fifth Avenue    New York<br>3    Carter    Thomas    Changan Street    Beijing<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### SQL ALTER TABLE 实例 ###</span><br><span class="line">现在，我们希望在表 &quot;Persons&quot; 中添加一个名为 &quot;Birthday&quot; 的新列。</span><br><span class="line"></span><br><span class="line">我们使用下列 SQL 语句：</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>ADD Birthday date<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">请注意，新列 &quot;Birthday&quot; 的类型是 date，可以存放日期。数据类型规定列中可以存放的数据的类型。</span><br><span class="line"></span><br><span class="line">新的 &quot;Persons&quot; 表类似这样：</span><br></pre></td></tr></table></figure></p>
<p>Id    LastName    FirstName    Address    City    Birthday<br>1    Adams    John    Oxford Street    London<br>2    Bush    George    Fifth Avenue    New York<br>3    Carter    Thomas    Changan Street    Beijing<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### 改变数据类型实例 ###</span><br><span class="line">现在我们希望改变 &quot;Persons&quot; 表中 &quot;Birthday&quot; 列的数据类型。</span><br><span class="line"></span><br><span class="line">我们使用下列 SQL 语句：</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons<br>ALTER COLUMN Birthday year<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">请注意，&quot;Birthday&quot; 列的数据类型是 year，可以存放 2 位或 4 位格式的年份。</span><br><span class="line"></span><br><span class="line">### DROP COLUMN 实例 ###</span><br><span class="line">接下来，我们删除 &quot;Person&quot; 表中的 &quot;Birthday&quot; 列：</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Person<br>DROP COLUMN Birthday<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Persons 表会成为这样:</span><br></pre></td></tr></table></figure></p>
<p>Id    LastName    FirstName    Address    City<br>1    Adams    John    Oxford Street    London<br>2    Bush    George    Fifth Avenue    New York<br>3    Carter    Thomas    Changan Street    Beijing<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL AUTO INCREMENT 字段 ##</span><br><span class="line"></span><br><span class="line">Auto-increment 会在新记录插入表中时生成一个唯一的数字。</span><br><span class="line"></span><br><span class="line">### AUTO INCREMENT 字段 ###</span><br><span class="line">我们通常希望在每次插入新记录时，自动地创建主键字段的值。</span><br><span class="line"></span><br><span class="line">我们可以在表中创建一个 auto-increment 字段。</span><br><span class="line"></span><br><span class="line">### 用于 MySQL 的语法 ###</span><br><span class="line">下列 SQL 语句把 &quot;Persons&quot; 表中的 &quot;P_Id&quot; 列定义为 auto-increment 主键：</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>P_Id int NOT NULL AUTO_INCREMENT,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255),<br>PRIMARY KEY (P_Id)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MySQL 使用 AUTO_INCREMENT 关键字来执行 auto-increment 任务。</span><br><span class="line"></span><br><span class="line">默认地，AUTO_INCREMENT 的开始值是 1，每条新记录递增 1。</span><br><span class="line"></span><br><span class="line">要让 AUTO_INCREMENT 序列以其他的值起始，请使用下列 SQL 语法：</span><br></pre></td></tr></table></figure></p>
<p>ALTER TABLE Persons AUTO_INCREMENT=100<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">要在 &quot;Persons&quot; 表中插入新记录，我们不必为 &quot;P_Id&quot; 列规定值（会自动添加一个唯一的值）：</span><br></pre></td></tr></table></figure></p>
<p>INSERT INTO Persons (FirstName,LastName)<br>VALUES (‘Bill’,’Gates’)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">上面的 SQL 语句会在 &quot;Persons&quot; 表中插入一条新记录。&quot;P_Id&quot; 会被赋予一个唯一的值。&quot;FirstName&quot; 会被设置为 &quot;Bill&quot;，&quot;LastName&quot; 列会被设置为 &quot;Gates&quot;。</span><br><span class="line"></span><br><span class="line">### 用于 SQL Server 的语法 ###</span><br><span class="line">下列 SQL 语句把 &quot;Persons&quot; 表中的 &quot;P_Id&quot; 列定义为 auto-increment 主键：</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>P_Id int PRIMARY KEY IDENTITY,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MS SQL 使用 IDENTITY 关键字来执行 auto-increment 任务。</span><br><span class="line"></span><br><span class="line">默认地，IDENTITY 的开始值是 1，每条新记录递增 1。</span><br><span class="line"></span><br><span class="line">要规定 &quot;P_Id&quot; 列以 20 起始且递增 10，请把 identity 改为</span><br></pre></td></tr></table></figure></p>
<p>IDENTITY(20,10)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">要在 &quot;Persons&quot; 表中插入新记录，我们不必为 &quot;P_Id&quot; 列规定值（会自动添加一个唯一的值）：</span><br></pre></td></tr></table></figure></p>
<p>INSERT INTO Persons (FirstName,LastName)<br>VALUES (‘Bill’,’Gates’)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">上面的 SQL 语句会在 &quot;Persons&quot; 表中插入一条新记录。&quot;P_Id&quot; 会被赋予一个唯一的值。&quot;FirstName&quot; 会被设置为 &quot;Bill&quot;，&quot;LastName&quot; 列会被设置为 &quot;Gates&quot;。</span><br><span class="line"></span><br><span class="line">### 用于 Access 的语法 ###</span><br><span class="line">下列 SQL 语句把 &quot;Persons&quot; 表中的 &quot;P_Id&quot; 列定义为 auto-increment 主键：</span><br></pre></td></tr></table></figure></p>
<p>CREATE TABLE Persons<br>(<br>P_Id int PRIMARY KEY AUTOINCREMENT,<br>LastName varchar(255) NOT NULL,<br>FirstName varchar(255),<br>Address varchar(255),<br>City varchar(255)<br>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MS Access 使用 AUTOINCREMENT 关键字来执行 auto-increment 任务。</span><br><span class="line"></span><br><span class="line">默认地，AUTOINCREMENT 的开始值是 1，每条新记录递增 1。</span><br><span class="line"></span><br><span class="line">要规定 &quot;P_Id&quot; 列以 20 起始且递增 10，请把 autoincrement 改为</span><br></pre></td></tr></table></figure></p>
<p>AUTOINCREMENT(20,10)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">要在 &quot;Persons&quot; 表中插入新记录，我们不必为 &quot;P_Id&quot; 列规定值（会自动添加一个唯一的值）：</span><br></pre></td></tr></table></figure></p>
<p>INSERT INTO Persons (FirstName,LastName)<br>VALUES (‘Bill’,’Gates’)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">上面的 SQL 语句会在 &quot;Persons&quot; 表中插入一条新记录。&quot;P_Id&quot; 会被赋予一个唯一的值。&quot;FirstName&quot; 会被设置为 &quot;Bill&quot;，&quot;LastName&quot; 列会被设置为 &quot;Gates&quot;。</span><br><span class="line"></span><br><span class="line">### 用于 Oracle 的语法 ###</span><br><span class="line">在 Oracle 中，代码稍微复杂一点。</span><br><span class="line"></span><br><span class="line">您必须通过 sequence 对创建 auto-increment 字段（该对象生成数字序列）。</span><br><span class="line"></span><br><span class="line">请使用下面的 CREATE SEQUENCE 语法：</span><br></pre></td></tr></table></figure></p>
<p>CREATE SEQUENCE seq_person<br>MINVALUE 1<br>START WITH 1<br>INCREMENT BY 1<br>CACHE 10<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">上面的代码创建名为 seq_person 的序列对象，它以 1 起始且以 1 递增。该对象缓存 10 个值以提高性能。CACHE 选项规定了为了提高访问速度要存储多少个序列值。</span><br><span class="line"></span><br><span class="line">要在 &quot;Persons&quot; 表中插入新记录，我们必须使用 nextval 函数（该函数从 seq_person 序列中取回下一个值）：</span><br></pre></td></tr></table></figure></p>
<p>INSERT INTO Persons (P_Id,FirstName,LastName)<br>VALUES (seq_person.nextval,’Lars’,’Monsen’)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">上面的 SQL 语句会在 &quot;Persons&quot; 表中插入一条新记录。&quot;P_Id&quot; 的赋值是来自 seq_person 序列的下一个数字。&quot;FirstName&quot; 会被设置为 &quot;Bill&quot;，&quot;LastName&quot; 列会被设置为 &quot;Gates&quot;。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL VIEW（视图） ##</span><br><span class="line"></span><br><span class="line">视图是可视化的表。</span><br><span class="line"></span><br><span class="line">本章讲解如何创建、更新和删除视图。</span><br><span class="line"></span><br><span class="line">### SQL CREATE VIEW 语句 ###</span><br><span class="line">什么是视图？</span><br><span class="line">在 SQL 中，视图是基于 SQL 语句的结果集的可视化的表。</span><br><span class="line"></span><br><span class="line">视图包含行和列，就像一个真实的表。视图中的字段就是来自一个或多个数据库中的真实的表中的字段。我们可以向视图添加 SQL 函数、WHERE 以及 JOIN 语句，我们也可以提交数据，就像这些来自于某个单一的表。</span><br><span class="line"></span><br><span class="line">注释：数据库的设计和结构不会受到视图中的函数、where 或 join 语句的影响。</span><br><span class="line"></span><br><span class="line">### SQL CREATE VIEW 语法 ###</span><br></pre></td></tr></table></figure></p>
<p>CREATE VIEW view_name AS<br>SELECT column_name(s)<br>FROM table_name<br>WHERE condition<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">注释：视图总是显示最近的数据。每当用户查询视图时，数据库引擎通过使用 SQL 语句来重建数据。</span><br><span class="line"></span><br><span class="line">### SQL CREATE VIEW 实例 ###</span><br><span class="line">可以从某个查询内部、某个存储过程内部，或者从另一个视图内部来使用视图。通过向视图添加函数、join 等等，我们可以向用户精确地提交我们希望提交的数据。</span><br><span class="line"></span><br><span class="line">样本数据库 Northwind 拥有一些被默认安装的视图。视图 &quot;Current Product List&quot; 会从 Products 表列出所有正在使用的产品。这个视图使用下列 SQL 创建：</span><br></pre></td></tr></table></figure></p>
<p>CREATE VIEW [Current Product List] AS<br>SELECT ProductID,ProductName<br>FROM Products<br>WHERE Discontinued=No<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我们可以查询上面这个视图：</span><br></pre></td></tr></table></figure></p>
<p>SELECT * FROM [Current Product List]<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Northwind 样本数据库的另一个视图会选取 Products 表中所有单位价格高于平均单位价格的产品：</span><br></pre></td></tr></table></figure></p>
<p>CREATE VIEW [Products Above Average Price] AS<br>SELECT ProductName,UnitPrice<br>FROM Products<br>WHERE UnitPrice&gt;(SELECT AVG(UnitPrice) FROM Products)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我们可以像这样查询上面这个视图：</span><br></pre></td></tr></table></figure></p>
<p>SELECT * FROM [Products Above Average Price]<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">另一个来自 Northwind 数据库的视图实例会计算在 1997 年每个种类的销售总数。请注意，这个视图会从另一个名为 &quot;Product Sales for 1997&quot; 的视图那里选取数据：</span><br></pre></td></tr></table></figure></p>
<p>CREATE VIEW [Category Sales For 1997] AS<br>SELECT DISTINCT CategoryName,Sum(ProductSales) AS CategorySales<br>FROM [Product Sales for 1997]<br>GROUP BY CategoryName<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我们可以像这样查询上面这个视图：</span><br></pre></td></tr></table></figure></p>
<p>SELECT * FROM [Category Sales For 1997]<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我们也可以向查询添加条件。现在，我们仅仅需要查看 &quot;Beverages&quot; 类的全部销量：</span><br></pre></td></tr></table></figure></p>
<p>SELECT * FROM [Category Sales For 1997]<br>WHERE CategoryName=’Beverages’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### SQL 更新视图 ###</span><br><span class="line">您可以使用下面的语法来更新视图：</span><br></pre></td></tr></table></figure></p>
<p>SQL CREATE OR REPLACE VIEW Syntax<br>CREATE OR REPLACE VIEW view_name AS<br>SELECT column_name(s)<br>FROM table_name<br>WHERE condition<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">现在，我们希望向 &quot;Current Product List&quot; 视图添加 &quot;Category&quot; 列。我们将通过下列 SQL 更新视图：</span><br></pre></td></tr></table></figure></p>
<p>CREATE VIEW [Current Product List] AS<br>SELECT ProductID,ProductName,Category<br>FROM Products<br>WHERE Discontinued=No<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### SQL 撤销视图 ###</span><br><span class="line">您可以通过 DROP VIEW 命令来删除视图。</span><br></pre></td></tr></table></figure></p>
<p>SQL DROP VIEW Syntax<br>DROP VIEW view_name<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL Date 函数 ##</span><br><span class="line"></span><br><span class="line">### SQL 日期 ###</span><br><span class="line">当我们处理日期时，最难的任务恐怕是确保所插入的日期的格式，与数据库中日期列的格式相匹配。</span><br><span class="line"></span><br><span class="line">只要数据包含的只是日期部分，运行查询就不会出问题。但是，如果涉及时间，情况就有点复杂了。</span><br><span class="line"></span><br><span class="line">在讨论日期查询的复杂性之前，我们先来看看最重要的内建日期处理函数。</span><br><span class="line"></span><br><span class="line">### MySQL Date 函数 ###</span><br><span class="line">下面的表格列出了 MySQL 中最重要的内建日期函数：</span><br></pre></td></tr></table></figure></p>
<p>函数    描述<br>NOW()    返回当前的日期和时间<br>CURDATE()    返回当前的日期<br>CURTIME()    返回当前的时间<br>DATE()    提取日期或日期/时间表达式的日期部分<br>EXTRACT()    返回日期/时间按的单独部分<br>DATE_ADD()    给日期添加指定的时间间隔<br>DATE_SUB()    从日期减去指定的时间间隔<br>DATEDIFF()    返回两个日期之间的天数<br>DATE_FORMAT()    用不同的格式显示日期/时间<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### SQL Server Date 函数 ###</span><br><span class="line">下面的表格列出了 SQL Server 中最重要的内建日期函数：</span><br></pre></td></tr></table></figure></p>
<p>函数    描述<br>GETDATE()    返回当前日期和时间<br>DATEPART()    返回日期/时间的单独部分<br>DATEADD()    在日期中添加或减去指定的时间间隔<br>DATEDIFF()    返回两个日期之间的时间<br>CONVERT()    用不同的格式显示日期/时间<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### SQL Date 数据类型 ###</span><br><span class="line">MySQL 使用下列数据类型在数据库中存储日期或日期/时间值：</span><br></pre></td></tr></table></figure></p>
<p>DATE - 格式 YYYY-MM-DD<br>DATETIME - 格式: YYYY-MM-DD HH:MM:SS<br>TIMESTAMP - 格式: YYYY-MM-DD HH:MM:SS<br>YEAR - 格式 YYYY 或 YY<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SQL Server 使用下列数据类型在数据库中存储日期或日期/时间值：</span><br></pre></td></tr></table></figure></p>
<p>DATE - 格式 YYYY-MM-DD<br>DATETIME - 格式: YYYY-MM-DD HH:MM:SS<br>SMALLDATETIME - 格式: YYYY-MM-DD HH:MM:SS<br>TIMESTAMP - 格式: 唯一的数字<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">### SQL 日期处理 ###</span><br><span class="line">如果不涉及时间部分，那么我们可以轻松地比较两个日期！</span><br><span class="line"></span><br><span class="line">假设我们有下面这个 &quot;Orders&quot; 表：</span><br></pre></td></tr></table></figure></p>
<p>OrderId    ProductName    OrderDate<br>1    computer    2008-12-26<br>2    printer    2008-12-26<br>3    electrograph    2008-11-12<br>4    telephone    2008-10-19<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">现在，我们希望从上表中选取 OrderDate 为 &quot;2008-12-26&quot; 的记录。</span><br><span class="line"></span><br><span class="line">我们使用如下 SELECT 语句：</span><br></pre></td></tr></table></figure></p>
<p>SELECT * FROM Orders WHERE OrderDate=’2008-12-26’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">结果集：</span><br></pre></td></tr></table></figure></p>
<p>OrderId    ProductName    OrderDate<br>1    computer    2008-12-26<br>3    electrograph    2008-12-26<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">现在假设 &quot;Orders&quot; 类似这样（请注意 &quot;OrderDate&quot; 列中的时间部分）：</span><br></pre></td></tr></table></figure></p>
<p>OrderId    ProductName    OrderDate<br>1    computer    2008-12-26 16:23:55<br>2    printer    2008-12-26 10:45:26<br>3    electrograph    2008-11-12 14:12:08<br>4    telephone    2008-10-19 12:56:10<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">如果我们使用上面的 SELECT 语句：</span><br></pre></td></tr></table></figure></p>
<p>SELECT * FROM Orders WHERE OrderDate=’2008-12-26’<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">那么我们得不到结果。这是由于该查询不含有时间部分的日期。</span><br><span class="line"></span><br><span class="line">提示：如果您希望使查询简单且更易维护，那么请不要在日期中使用时间部分！</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL NULL 值 ##</span><br><span class="line"></span><br><span class="line">NULL 值是遗漏的未知数据。</span><br><span class="line"></span><br><span class="line">默认地，表的列可以存放 NULL 值。</span><br><span class="line"></span><br><span class="line">本章讲解 IS NULL 和 IS NOT NULL 操作符。</span><br><span class="line"></span><br><span class="line">### SQL NULL 值 ###</span><br><span class="line">如果表中的某个列是可选的，那么我们可以在不向该列添加值的情况下插入新记录或更新已有的记录。这意味着该字段将以 NULL 值保存。</span><br><span class="line"></span><br><span class="line">NULL 值的处理方式与其他值不同。</span><br><span class="line"></span><br><span class="line">NULL 用作未知的或不适用的值的占位符。</span><br><span class="line"></span><br><span class="line">注释：无法比较 NULL 和 0；它们是不等价的。</span><br><span class="line"></span><br><span class="line">### SQL 的 NULL 值处理 ###</span><br><span class="line">请看下面的 &quot;Persons&quot; 表：</span><br></pre></td></tr></table></figure></p>
<p>Id    LastName    FirstName    Address    City<br>1    Adams    John         London<br>2    Bush    George    Fifth Avenue    New York<br>3    Carter    Thomas         Beijing<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">假如 &quot;Persons&quot; 表中的 &quot;Address&quot; 列是可选的。这意味着如果在 &quot;Address&quot; 列插入一条不带值的记录，&quot;Address&quot; 列会使用 NULL 值保存。</span><br><span class="line"></span><br><span class="line">那么我们如何测试 NULL 值呢？</span><br><span class="line"></span><br><span class="line">无法使用比较运算符来测试 NULL 值，比如 =, &lt;, 或者 &lt;&gt;。</span><br><span class="line"></span><br><span class="line">我们必须使用 IS NULL 和 IS NOT NULL 操作符。</span><br><span class="line"></span><br><span class="line">### SQL IS NULL ###</span><br><span class="line">我们如何仅仅选取在 &quot;Address&quot; 列中带有 NULL 值的记录呢？</span><br><span class="line"></span><br><span class="line">我们必须使用 IS NULL 操作符：</span><br></pre></td></tr></table></figure></p>
<p>SELECT LastName,FirstName,Address FROM Persons<br>WHERE Address IS NULL<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">结果集：</span><br></pre></td></tr></table></figure></p>
<p>LastName    FirstName    Address<br>Adams    John<br>Carter    Thomas<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">提示：请始终使用 IS NULL 来查找 NULL 值。</span><br><span class="line"></span><br><span class="line">### SQL IS NOT NULL ###</span><br><span class="line">我们如何选取在 &quot;Address&quot; 列中不带有 NULL 值的记录呢？</span><br><span class="line"></span><br><span class="line">我们必须使用 IS NOT NULL 操作符：</span><br></pre></td></tr></table></figure></p>
<p>SELECT LastName,FirstName,Address FROM Persons<br>WHERE Address IS NOT NULL<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">结果集：</span><br></pre></td></tr></table></figure></p>
<p>LastName    FirstName    Address<br>Bush    George    Fifth Avenue<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">在下面，我们了解 ISNULL()、NVL()、IFNULL() 和 COALESCE() 函数。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL NULL 函数 ##</span><br><span class="line"></span><br><span class="line">### SQL ISNULL()、NVL()、IFNULL() 和 COALESCE() 函数 ###</span><br><span class="line">请看下面的 &quot;Products&quot; 表：</span><br></pre></td></tr></table></figure></p>
<p>P_Id    ProductName    UnitPrice    UnitsInStock    UnitsOnOrder<br>1    computer    699    25    15<br>2    printer    365    36<br>3    telephone    280    159    57<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">假如 &quot;UnitsOnOrder&quot; 是可选的，而且可以包含 NULL 值。</span><br><span class="line"></span><br><span class="line">我们使用如下 SELECT 语句：</span><br></pre></td></tr></table></figure></p>
<p>SELECT ProductName,UnitPrice*(UnitsInStock+UnitsOnOrder)<br>FROM Products<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">在上面的例子中，如果有 &quot;UnitsOnOrder&quot; 值是 NULL，那么结果是 NULL。</span><br><span class="line"></span><br><span class="line">微软的 ISNULL() 函数用于规定如何处理 NULL 值。</span><br><span class="line"></span><br><span class="line">NVL(), IFNULL() 和 COALESCE() 函数也可以达到相同的结果。</span><br><span class="line"></span><br><span class="line">在这里，我们希望 NULL 值为 0。</span><br><span class="line"></span><br><span class="line">下面，如果 &quot;UnitsOnOrder&quot; 是 NULL，则不利于计算，因此如果值是 NULL 则 ISNULL() 返回 0。</span><br><span class="line"></span><br><span class="line">### SQL Server / MS Access ###</span><br></pre></td></tr></table></figure></p>
<p>SELECT ProductName,UnitPrice*(UnitsInStock+ISNULL(UnitsOnOrder,0))<br>FROM Products<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">### Oracle ###</span><br><span class="line">Oracle 没有 ISNULL() 函数。不过，我们可以使用 NVL() 函数达到相同的结果：</span><br></pre></td></tr></table></figure></p>
<p>SELECT ProductName,UnitPrice*(UnitsInStock+NVL(UnitsOnOrder,0))<br>FROM Products<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">### MySQL ###</span><br><span class="line">MySQL 也拥有类似 ISNULL() 的函数。不过它的工作方式与微软的 ISNULL() 函数有点不同。</span><br><span class="line"></span><br><span class="line">在 MySQL 中，我们可以使用 IFNULL() 函数，就像这样：</span><br></pre></td></tr></table></figure></p>
<p>SELECT ProductName,UnitPrice*(UnitsInStock+IFNULL(UnitsOnOrder,0))<br>FROM Products<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">或者我们可以使用 COALESCE() 函数，就像这样：</span><br></pre></td></tr></table></figure></p>
<p>SELECT ProductName,UnitPrice*(UnitsInStock+COALESCE(UnitsOnOrder,0))<br>FROM Products<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">----------</span><br><span class="line">## SQL 数据类型 ##</span><br><span class="line"></span><br><span class="line">Microsoft Access、MySQL 以及 SQL Server 所使用的数据类型和范围。</span><br><span class="line"></span><br><span class="line">### Microsoft Access 数据类型 ###</span><br></pre></td></tr></table></figure></p>
<p>数据类型    描述    存储<br>Text    用于文本或文本与数字的组合。最多 255 个字符。<br>Memo<br>Memo 用于更大数量的文本。最多存储 65,536 个字符。</p>
<p>注释：无法对 memo 字段进行排序。不过它们是可搜索的。</p>
<p>Byte    允许 0 到 255 的数字。    1 字节<br>Integer    允许介于 -32,768 到 32,767 之间的数字。    2 字节<br>Long    允许介于 -2,147,483,648 与 2,147,483,647 之间的全部数字    4 字节<br>Single    单精度浮点。处理大多数小数。    4 字节<br>Double    双精度浮点。处理大多数小数。    8 字节<br>Currency<br>用于货币。支持 15 位的元，外加 4 位小数。</p>
<p>提示：您可以选择使用哪个国家的货币。</p>
<p>8 字节<br>AutoNumber    AutoNumber 字段自动为每条记录分配数字，通常从 1 开始。    4 字节<br>Date/Time    用于日期和时间    8 字节<br>Yes/No<br>逻辑字段，可以显示为 Yes/No、True/False 或 On/Off。</p>
<p>在代码中，使用常量 True 和 False （等价于 1 和 0）</p>
<p>注释：Yes/No 字段中不允许 Null 值</p>
<p>1 比特<br>Ole Object    可以存储图片、音频、视频或其他 BLOBs (Binary Large OBjects)    最多 1GB<br>Hyperlink    包含指向其他文件的链接，包括网页。<br>Lookup Wizard    允许你创建一个可从下列列表中进行选择的选项列表。    4 字节<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">### MySQL 数据类型 ###</span><br><span class="line">在 MySQL 中，有三种主要的类型：文本、数字和日期/时间类型。</span><br><span class="line"></span><br><span class="line">#### Text 类型： ####</span><br></pre></td></tr></table></figure></p>
<p>数据类型    描述<br>CHAR(size)    保存固定长度的字符串（可包含字母、数字以及特殊字符）。在括号中指定字符串的长度。最多 255 个字符。<br>VARCHAR(size)<br>保存可变长度的字符串（可包含字母、数字以及特殊字符）。在括号中指定字符串的最大长度。最多 255 个字符。</p>
<p>注释：如果值的长度大于 255，则被转换为 TEXT 类型。</p>
<p>TINYTEXT    存放最大长度为 255 个字符的字符串。<br>TEXT    存放最大长度为 65,535 个字符的字符串。<br>BLOB    用于 BLOBs (Binary Large OBjects)。存放最多 65,535 字节的数据。<br>MEDIUMTEXT    存放最大长度为 16,777,215 个字符的字符串。<br>MEDIUMBLOB    用于 BLOBs (Binary Large OBjects)。存放最多 16,777,215 字节的数据。<br>LONGTEXT    存放最大长度为 4,294,967,295 个字符的字符串。<br>LONGBLOB    用于 BLOBs (Binary Large OBjects)。存放最多 4,294,967,295 字节的数据。<br>ENUM(x,y,z,etc.)<br>允许你输入可能值的列表。可以在 ENUM 列表中列出最大 65535 个值。如果列表中不存在插入的值，则插入空值。</p>
<p>注释：这些值是按照你输入的顺序存储的。</p>
<p>可以按照此格式输入可能的值：ENUM(‘X’,’Y’,’Z’)</p>
<p>SET    与 ENUM 类似，SET 最多只能包含 64 个列表项，不过 SET 可存储一个以上的值。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### Number 类型： ####</span><br></pre></td></tr></table></figure></p>
<p>数据类型    描述<br>TINYINT(size)    -128 到 127 常规。0 到 255 无符号<em>。在括号中规定最大位数。<br>SMALLINT(size)    -32768 到 32767 常规。0 到 65535 无符号</em>。在括号中规定最大位数。<br>MEDIUMINT(size)    -8388608 到 8388607 普通。0 to 16777215 无符号<em>。在括号中规定最大位数。<br>INT(size)    -2147483648 到 2147483647 常规。0 到 4294967295 无符号</em>。在括号中规定最大位数。<br>BIGINT(size)    -9223372036854775808 到 9223372036854775807 常规。0 到 18446744073709551615 无符号*。在括号中规定最大位数。<br>FLOAT(size,d)    带有浮动小数点的小数字。在括号中规定最大位数。在 d 参数中规定小数点右侧的最大位数。<br>DOUBLE(size,d)    带有浮动小数点的大数字。在括号中规定最大位数。在 d 参数中规定小数点右侧的最大位数。<br>DECIMAL(size,d)    作为字符串存储的 DOUBLE 类型，允许固定的小数点。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 这些整数类型拥有额外的选项 UNSIGNED。通常，整数可以是负数或正数。如果添加 UNSIGNED 属性，那么范围将从 0 开始，而不是某个负数。</span><br><span class="line"></span><br><span class="line">#### Date 类型： ####</span><br></pre></td></tr></table></figure></p>
<p>数据类型    描述<br>DATE()<br>日期。格式：YYYY-MM-DD</p>
<p>注释：支持的范围是从 ‘1000-01-01’ 到 ‘9999-12-31’</p>
<p>DATETIME()<br>*日期和时间的组合。格式：YYYY-MM-DD HH:MM:SS</p>
<p>注释：支持的范围是从 ‘1000-01-01 00:00:00’ 到 ‘9999-12-31 23:59:59’</p>
<p>TIMESTAMP()<br>*时间戳。TIMESTAMP 值使用 Unix 纪元(‘1970-01-01 00:00:00’ UTC) 至今的描述来存储。格式：YYYY-MM-DD HH:MM:SS</p>
<p>注释：支持的范围是从 ‘1970-01-01 00:00:01’ UTC 到 ‘2038-01-09 03:14:07’ UTC</p>
<p>TIME()    时间。格式：HH:MM:SS 注释：支持的范围是从 ‘-838:59:59’ 到 ‘838:59:59’<br>YEAR()<br>2 位或 4 位格式的年。</p>
<p>注释：4 位格式所允许的值：1901 到 2155。2 位格式所允许的值：70 到 69，表示从 1970 到 2069。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">* 即便 DATETIME 和 TIMESTAMP 返回相同的格式，它们的工作方式很不同。在 INSERT 或 UPDATE 查询中，TIMESTAMP 自动把自身设置为当前的日期和时间。TIMESTAMP 也接受不同的格式，比如 YYYYMMDDHHMMSS、YYMMDDHHMMSS、YYYYMMDD 或 YYMMDD。</span><br><span class="line"></span><br><span class="line">### SQL Server 数据类型 ###</span><br><span class="line">#### Character 字符串： ####</span><br></pre></td></tr></table></figure></p>
<p>数据类型    描述    存储<br>char(n)    固定长度的字符串。最多 8,000 个字符。    n<br>varchar(n)    可变长度的字符串。最多 8,000 个字符。<br>varchar(max)    可变长度的字符串。最多 1,073,741,824 个字符。<br>text    可变长度的字符串。最多 2GB 字符数据。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#### Unicode 字符串： ####</span><br></pre></td></tr></table></figure></p>
<p>数据类型    描述    存储<br>nchar(n)    固定长度的 Unicode 数据。最多 4,000 个字符。<br>nvarchar(n)    可变长度的 Unicode 数据。最多 4,000 个字符。<br>nvarchar(max)    可变长度的 Unicode 数据。最多 536,870,912 个字符。<br>ntext    可变长度的 Unicode 数据。最多 2GB 字符数据。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#### Binary 类型： ####</span><br></pre></td></tr></table></figure></p>
<p>数据类型    描述    存储<br>bit    允许 0、1 或 NULL<br>binary(n)    固定长度的二进制数据。最多 8,000 字节。<br>varbinary(n)    可变长度的二进制数据。最多 8,000 字节。<br>varbinary(max)    可变长度的二进制数据。最多 2GB 字节。<br>image    可变长度的二进制数据。最多 2GB。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#### Number 类型： ####</span><br></pre></td></tr></table></figure></p>
<p>数据类型    描述    存储<br>tinyint    允许从 0 到 255 的所有数字。    1 字节<br>smallint    允许从 -32,768 到 32,767 的所有数字。    2 字节<br>int    允许从 -2,147,483,648 到 2,147,483,647 的所有数字。    4 字节<br>bigint    允许介于 -9,223,372,036,854,775,808 和 9,223,372,036,854,775,807 之间的所有数字。    8 字节<br>decimal(p,s)<br>固定精度和比例的数字。允许从 -10^38 +1 到 10^38 -1 之间的数字。</p>
<p>p 参数指示可以存储的最大位数（小数点左侧和右侧）。p 必须是 1 到 38 之间的值。默认是 18。</p>
<p>s 参数指示小数点右侧存储的最大位数。s 必须是 0 到 p 之间的值。默认是 0。</p>
<p>5-17 字节<br>numeric(p,s)<br>固定精度和比例的数字。允许从 -10^38 +1 到 10^38 -1 之间的数字。</p>
<p>p 参数指示可以存储的最大位数（小数点左侧和右侧）。p 必须是 1 到 38 之间的值。默认是 18。</p>
<p>s 参数指示小数点右侧存储的最大位数。s 必须是 0 到 p 之间的值。默认是 0。</p>
<p>5-17 字节<br>smallmoney    介于 -214,748.3648 和 214,748.3647 之间的货币数据。    4 字节<br>money    介于 -922,337,203,685,477.5808 和 922,337,203,685,477.5807 之间的货币数据。    8 字节<br>float(n)    从 -1.79E + 308 到 1.79E + 308 的浮动精度数字数据。 参数 n 指示该字段保存 4 字节还是 8 字节。float(24) 保存 4 字节，而 float(53) 保存 8 字节。n 的默认值是 53。    4 或 8 字节<br>real    从 -3.40E + 38 到 3.40E + 38 的浮动精度数字数据。    4 字节<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#### Date 类型： ####</span><br></pre></td></tr></table></figure></p>
<p>数据类型    描述    存储<br>datetime    从 1753 年 1 月 1 日 到 9999 年 12 月 31 日，精度为 3.33 毫秒。    8 bytes<br>datetime2    从 1753 年 1 月 1 日 到 9999 年 12 月 31 日，精度为 100 纳秒。    6-8 bytes<br>smalldatetime    从 1900 年 1 月 1 日 到 2079 年 6 月 6 日，精度为 1 分钟。    4 bytes<br>date    仅存储日期。从 0001 年 1 月 1 日 到 9999 年 12 月 31 日。    3 bytes<br>time    仅存储时间。精度为 100 纳秒。    3-5 bytes<br>datetimeoffset    与 datetime2 相同，外加时区偏移。    8-10 bytes<br>timestamp    存储唯一的数字，每当创建或修改某行时，该数字会更新。timestamp 基于内部时钟，不对应真实时间。每个表只能有一个 timestamp 变量。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#### 其他数据类型： ####</span><br></pre></td></tr></table></figure></p>
<p>数据类型    描述<br>sql_variant    存储最多 8,000 字节不同数据类型的数据，除了 text、ntext 以及 timestamp。<br>uniqueidentifier    存储全局标识符 (GUID)。<br>xml    存储 XML 格式化数据。最多 2GB。<br>cursor    存储对用于数据库操作的指针的引用。<br>table    存储结果集，供稍后处理。<br><code>`</code></p>
<hr>
<h2 id="SQL-服务器-RDBMS"><a href="#SQL-服务器-RDBMS" class="headerlink" title="SQL 服务器 - RDBMS"></a>SQL 服务器 - RDBMS</h2><p>现代的 SQL 服务器构建在 RDBMS 之上。</p>
<h3 id="DBMS-数据库管理系统（Database-Management-System）"><a href="#DBMS-数据库管理系统（Database-Management-System）" class="headerlink" title="DBMS - 数据库管理系统（Database Management System）"></a>DBMS - 数据库管理系统（Database Management System）</h3><p>数据库管理系统是一种可以访问数据库中数据的计算机程序。</p>
<p>DBMS 使我们有能力在数据库中提取、修改或者存贮信息。</p>
<p>不同的 DBMS 提供不同的函数供查询、提交以及修改数据。</p>
<h3 id="RDBMS-关系数据库管理系统（Relational-Database-Management-System）"><a href="#RDBMS-关系数据库管理系统（Relational-Database-Management-System）" class="headerlink" title="RDBMS - 关系数据库管理系统（Relational Database Management System）"></a>RDBMS - 关系数据库管理系统（Relational Database Management System）</h3><p>关系数据库管理系统 (RDBMS) 也是一种数据库管理系统，其数据库是根据数据间的关系来组织和访问数据的。</p>
<p>20 世纪 70 年代初，IBM 公司发明了 RDBMS。</p>
<p>RDBMS 是 SQL 的基础，也是所有现代数据库系统诸如 Oracle、SQL Server、IBM DB2、Sybase、MySQL 以及 Microsoft Access 的基础。</p>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/数据分析/">数据分析</a>
  </div>

        
  <div class="tags">
    <a href="/tags/SQL/">SQL</a>
  </div>

        
  <div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a title="分享到QQ空间" href="#" class="bds_qzone" data-cmd="qzone"></a><a title="分享到新浪微博" href="#" class="bds_tsina" data-cmd="tsina"></a><a title="分享到腾讯微博" href="#" class="bds_tqq" data-cmd="tqq"></a><a title="分享到人人网" href="#" class="bds_renren" data-cmd="renren"></a><a title="分享到微信" href="#" class="bds_weixin" data-cmd="weixin"></a></div>
  <script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{},"image":{"viewList":["qzone","tsina","tqq","renren","weixin"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["qzone","tsina","tqq","renren","weixin"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>
<!-- 返回顶部 -->
<div id="toTop">
	<a href="#">▲</a>
	<a href="#footer">▼</a>
</div></div></div>
      <aside id="sidebar" class="alignright">
        
           <div class="search">
  <form action="/search/index.html" method="get" accept-charset="utf-8">
<!--     <input type="search" name="wd"results="0" placeholder="搜索">
    <input type="hidden" name="wd" value="site:paradoxallen.github.io"> -->
     <input type="text" id="search" class="st-default-search-input" placeholder="搜索" style="height: 100%" />
  </form>
</div> 
        
          
<div class="widget tag">
  <h3 class="title" id="categories">分类</h3>
     <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/个人随笔/">个人随笔</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/博客开发/">博客开发</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/应用统计/">应用统计</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数学基础/">数学基础</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据分析/">数据分析</a><span class="category-list-count">9</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据挖掘/">数据挖掘</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a><span class="category-list-count">18</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程相关/">编程相关</a><span class="category-list-count">26</span></li></ul> 
</div>
 

        
          
<div class="widget tagcloud">
  <h3 class="title">标签</h3>
  <div class="entry">
    <a href="/tags/Excel/" style="font-size: 12.5px;">Excel</a> <a href="/tags/GitHub/" style="font-size: 10px;">GitHub</a> <a href="/tags/Machine-Learning/" style="font-size: 15px;">Machine Learning</a> <a href="/tags/Machine-Learning-课程笔记/" style="font-size: 18.75px;">Machine Learning 课程笔记</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/SQL/" style="font-size: 13.75px;">SQL</a> <a href="/tags/hexo/" style="font-size: 11.25px;">hexo</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/博客/" style="font-size: 11.25px;">博客</a> <a href="/tags/可视化/" style="font-size: 10px;">可视化</a> <a href="/tags/大气科学/" style="font-size: 10px;">大气科学</a> <a href="/tags/提问/" style="font-size: 10px;">提问</a> <a href="/tags/数据类型/" style="font-size: 10px;">数据类型</a> <a href="/tags/机器学习/" style="font-size: 16.25px;">机器学习</a> <a href="/tags/概率论与数理统计/" style="font-size: 10px;">概率论与数理统计</a> <a href="/tags/模型/" style="font-size: 12.5px;">模型</a> <a href="/tags/爬虫/" style="font-size: 17.5px;">爬虫</a> <a href="/tags/目录/" style="font-size: 10px;">目录</a> <a href="/tags/算法/" style="font-size: 11.25px;">算法</a> <a href="/tags/线性代数/" style="font-size: 10px;">线性代数</a> <a href="/tags/统计/" style="font-size: 10px;">统计</a> <a href="/tags/编码/" style="font-size: 10px;">编码</a> <a href="/tags/高等数学/" style="font-size: 10px;">高等数学</a>
  </div>
</div>

        
          
  <div class="widget tag">
    <h3 class="title">归档</h3>
	<ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">11</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">4</span></li></ul>
  </div>

        
      </aside>
      <div class="clearfix"></div>
    </div>
  <footer id="footer"><div class="footer-content inner">
  <div class="alignleft">
  
    &copy; 2020 LRP
    
  </div>

  <!--
  <div class="alignright">
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, Theme
    <a href="https://github.com/pengloo53/Hexo-theme-light_cn">light_cn</a>
  </div>
  -->

  <!--
  <div>
    Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a>
  </div>
  -->
  
  <div class="clearfix"></div>
</div></footer>
  <script src="http://libs.baidu.com/jquery/2.1.1/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>

<!-- calendar widget -->


<!-- 百度统计 -->

	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?9acf0cedd48dc53be256ede5a98c2aaa";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>


<!-- fancybox -->

<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
</html>